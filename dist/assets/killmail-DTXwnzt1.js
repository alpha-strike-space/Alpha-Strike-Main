import{e as F,h as S,g as b,s as L,t as E,a as N,j as H,k as M,m as A,n as P,b as R,l as K,i as B}from"./common-uHi2LkPz.js";let p=null;const e=(t,l="",i={})=>{var a,m;const o=b[H];let n=((a=E[t])==null?void 0:a[o])||((m=E[t])==null?void 0:m.en)||l||t;for(const c in i)n=n.replace(new RegExp(`{${c}}`,"g"),i[c]);return n},I=(t,l)=>t==null||typeof t=="string"&&t.trim()===""?e(`general.${l.toLowerCase()}`,l):String(t);function $(t,l){const i=document.createElement("div");i.className=`combatant-column-km ${l}-column`;const o=document.createElement("div");o.className=`combatant-card-km ${l}-card-km`;const n=document.createElement("div");n.className="combatant-header-km";const a=document.createElement("img");a.className="profile-image",a.alt=e(`altText.${l}Image`,`${l} ${t.name}`,{name:t.name}),a.src=M(t.portrait_url,"../");const m=document.createElement("div");m.className="combatant-info-km";const c=document.createElement("h3");c.className=`combatant-role-label ${l}`,c.textContent=e(`killmail.${l}Label`,l.toUpperCase());const r=document.createElement("h2");r.className=`${l} clickable-name`,r.dataset.name=t.name,r.title=e("tooltip.searchFor","Search for {itemName}",{itemName:t.name}),r.textContent=t.name;const s=document.createElement("p");s.innerHTML=`${e("killmail.corporationLabel","Corporation:")} <span class="placeholder">${e(`killmail.placeholder.${l}Corp`,`[${l} Corp Placeholder]`)}</span>`;const d=document.createElement("p"),h=l==="victim"&&(t.loss_type==="ship"||t.loss_type==="pod")?t.loss_type:e(`killmail.placeholder.${l}Ship`,`[${l} Ship Placeholder]`);return d.innerHTML=`${e("killmail.shipLabel","Ship:")} <span class="placeholder">${h}</span>`,m.appendChild(c),m.appendChild(r),m.appendChild(s),m.appendChild(d),n.appendChild(a),n.appendChild(m),o.appendChild(n),i.appendChild(o),i}function O(t){const l=document.createElement("div");l.className="engagement-details-km data-card";const i=document.createElement("h3");i.textContent=e("killmail.engagementDetailsTitle","Engagement Details");const o=document.createElement("p");o.innerHTML=`<strong>${e("killmail.lossTypeLabel","Loss Type:")}</strong> ${t.loss_type}`;const n=document.createElement("p");n.innerHTML=`<strong>${e("killmail.timeLabel","Time:")}</strong> ${A(t.time_stamp,P)}`;const a=document.createElement("p"),m=document.createElement("span");return m.className="clickable-system",m.dataset.system=t.solar_system_name,m.title=e("tooltip.searchFor","Search for {itemName}",{itemName:t.solar_system_name}),m.textContent=t.solar_system_name,a.innerHTML=`<strong>${e("killmail.locationLabel","Location:")}</strong> `,a.appendChild(m),a.innerHTML+=` (${e("card.idLabel","ID:")} ${t.solar_system_id})`,l.appendChild(i),l.appendChild(o),l.appendChild(n),l.appendChild(a),l}function U(t,l,i){const o=document.createElement("details");o.className="fitting-category",o.setAttribute("open","");const n=document.createElement("summary");n.innerHTML=`<i class="fas fa-${l}"></i> ${t}`;const a=document.createElement("ul"),m=document.createDocumentFragment();return i.forEach(c=>{const r=document.createElement("li"),s=document.createElement("span");s.className="placeholder",s.textContent=c,r.appendChild(s),m.appendChild(r)}),a.appendChild(m),o.appendChild(n),o.appendChild(a),o}function j(){const t=document.createElement("div");t.className="fitting-section-km data-card";const l=document.createElement("h3");l.textContent=e("killmail.fittingTitle","Ship Fitting & Contents");const i=document.createElement("p");i.className="note",i.innerHTML=`<i class="fas fa-info-circle"></i> ${e("killmail.fittingNote","Note: Fitting data is placeholder.")}`;const o=document.createElement("div");return o.className="fitting-table-km",[{title:e("killmail.fitting.highSlots","High Slots"),icon:"crosshairs",items:[e("killmail.placeholder.highSlotItem1","[High Slot Item 1]"),e("killmail.placeholder.highSlotItem2","[High Slot Item 2]"),e("killmail.placeholder.emptyHighSlot","[Empty High Slot]")]},{title:e("killmail.fitting.midSlots","Mid Slots"),icon:"shield-alt",items:[e("killmail.placeholder.midSlotItem1","[Mid Slot Item 1]"),e("killmail.placeholder.midSlotItem2","[Mid Slot Item 2]"),e("killmail.placeholder.midSlotItem3","[Mid Slot Item 3]")]},{title:e("killmail.fitting.lowSlots","Low Slots"),icon:"cogs",items:[e("killmail.placeholder.lowSlotItem1","[Low Slot Item 1]"),e("killmail.placeholder.lowSlotItem2","[Low Slot Item 2]"),e("killmail.placeholder.lowSlotItem3","[Low Slot Item 3]")]},{title:e("killmail.fitting.rigs","Rigs"),icon:"microchip",items:[e("killmail.placeholder.rigSlotItem1","[Rig Slot Item 1]"),e("killmail.placeholder.rigSlotItem2","[Rig Slot Item 2]"),e("killmail.placeholder.rigSlotItem3","[Rig Slot Item 3]")]},{title:e("killmail.fitting.drones","Drones"),icon:"fighter-jet",items:[e("killmail.placeholder.droneItem1","[Drone Item 1]"),e("killmail.placeholder.droneItem2","[Drone Item 2]")]},{title:e("killmail.fitting.ammoCharges","Ammunition / Charges"),icon:"cubes",items:[e("killmail.placeholder.ammoItem1","[Ammo Item 1]"),e("killmail.placeholder.ammoItem2","[Ammo Item 2]"),e("killmail.placeholder.ammoItem3","[Ammo Item 3]")]},{title:e("killmail.fitting.cargoHold","Cargo Hold"),icon:"box-open",items:[e("killmail.placeholder.cargoItem1","[Cargo Item 1]"),e("killmail.placeholder.cargoItem2","[Cargo Item 2]"),e("killmail.placeholder.cargoItem3","[Cargo Item 3]")]}].forEach(a=>{o.appendChild(U(a.title,a.icon,a.items))}),t.appendChild(l),t.appendChild(i),t.appendChild(o),t}function T(t){const l=document.getElementById("killmail-content"),i=document.getElementById("killmail-page-title-container"),o=document.querySelector("title");if(!l||!i||!o){console.error("One or more essential DOM elements for killmail detail page are missing."),l&&(l.innerHTML=`<p class="error">${e("error.generic","An error occurred.")}</p>`);return}if(!t){l.innerHTML=`<p class="error">${e("error.killmailLoadFailed","Killmail data is not available to render.")}</p>`;return}const n=I(t.victim_name,"unknown"),a=I(t.killer_name,"notApplicable"),m=I(t.solar_system_name,"unknown"),c=I(t.loss_type,"classified");o.textContent=e("killmail.pageTitlePattern","Killmail: {killerName} vs {victimName}",{killerName:a,victimName:n});const r=document.createDocumentFragment(),s=document.createElement("h1"),d=document.createElement("span");d.className="killer clickable-name",d.dataset.name=a,d.title=e("tooltip.searchFor","Search for {itemName}",{itemName:a}),d.textContent=a;const h=document.createElement("span");h.className="text-primary",h.textContent=` ${e("killmail.headerVs","vs")} `;const g=document.createElement("span");g.className="victim clickable-name",g.dataset.name=n,g.title=e("tooltip.searchFor","Search for {itemName}",{itemName:n}),g.textContent=n,s.appendChild(d),s.appendChild(h),s.appendChild(g);const k=document.createElement("p");k.className="system-location";const w=document.createTextNode(`${e("killmail.headerIncidentIn","Incident in")} `),u=document.createElement("span");u.className="clickable-system",u.dataset.system=m,u.title=e("tooltip.searchFor","Search for {itemName}",{itemName:m}),u.textContent=m,k.appendChild(w),k.appendChild(u),r.appendChild(s),r.appendChild(k),i.textContent="",i.appendChild(r);const C=document.createDocumentFragment(),f=document.createElement("div");f.className="combatants-grid-km";const y={name:a,loss_type:c,portrait_url:t.killer_portrait_url},x={name:n,loss_type:c,portrait_url:t.victim_portrait_url};f.appendChild($(y,"killer")),f.appendChild($(x,"victim")),C.appendChild(f);const D=O(t);C.appendChild(D);const v=j();C.appendChild(v),l.textContent="",l.appendChild(C),typeof N=="function"&&N()}function G(){p?T(p):_()}async function _(){const l=new URLSearchParams(window.location.search).get("mail_id"),i=document.getElementById("killmail-content");if(!i){console.error("killmail-content element not found in DOM.");return}if(l)try{if(!p||p.id!==Number.parseInt(l)){const n=await F(l);if(!n||n.length===0)throw S(),new Error(e("error.killmailNotFound","Killmail not found."));p=n[0]}T(p)}catch(n){console.error("Failed to load killmail data from API:",n),p=null,i.innerHTML=`<p class="error">${e("error.killmailLoadFailedApi",n.message||"Failed to load killmail data from API.")}</p>`}else p=null,i.innerHTML=`<p class="error">${e("error.noKillmailId","No killmail ID provided in URL.")}</p>`;const o=localStorage.getItem("preferredLanguage")||b[0];typeof L=="function"&&L(o),S()}R();document.addEventListener("DOMContentLoaded",async()=>{await K(),B("killmail_detail"),await _(),typeof window.AlphaStrike>"u"&&(window.AlphaStrike={}),window.AlphaStrike.onLanguageChangeRenderContent=G,S()});
