import{s as M,l as v,i as x,a as D,h as C,b as $,e as I,t as S,g as L,j as A,k as F,m as P}from"./common-BHtRRLpG.js";let d=null;const e=(l,t="",n={})=>{var i,m;const o=$[A];let a=((i=S[l])==null?void 0:i[o])||((m=S[l])==null?void 0:m.en)||t||l;for(const r in n)a=a.replace(new RegExp(`{${r}}`,"g"),n[r]);return a},u=(l,t)=>l==null||typeof l=="string"&&l.trim()===""?e(`general.${t.toLowerCase()}`,t):String(l);function E(l,t){const n=document.createElement("div");n.className=`combatant-column-km ${t}-column`;const o=document.createElement("div");o.className=`combatant-card-km ${t}-card-km`;const a=document.createElement("div");a.className="combatant-header-km";const i=document.createElement("img");i.className="profile-image",i.alt=e(`altText.${t}Image`,`${t} ${l.name}`,{name:l.name}),i.src="../assets/images/default-avatar.avif";const m=document.createElement("div");m.className="combatant-info-km";const r=document.createElement("h3");r.className=`combatant-role-label ${t}`,r.textContent=e(`killmail.${t}Label`,t.toUpperCase());const c=document.createElement("h2");c.className=`${t} clickable-name`,c.dataset.name=l.name,c.title=e("tooltip.searchFor","Search for {itemName}",{itemName:l.name}),c.textContent=l.name;const s=document.createElement("p");s.innerHTML=`${e("killmail.corporationLabel","Corporation:")} <span class="placeholder">${e(`killmail.placeholder.${t}Corp`,`[${t} Corp Placeholder]`)}</span>`;const h=document.createElement("p"),p=t==="victim"&&(l.loss_type==="ship"||l.loss_type==="pod")?l.loss_type:e(`killmail.placeholder.${t}Ship`,`[${t} Ship Placeholder]`);return h.innerHTML=`${e("killmail.shipLabel","Ship:")} <span class="placeholder">${p}</span>`,m.appendChild(r),m.appendChild(c),m.appendChild(s),m.appendChild(h),a.appendChild(i),a.appendChild(m),o.appendChild(a),n.appendChild(o),n}function R(l){const t=document.createElement("div");t.className="engagement-details-km data-card";const n=document.createElement("h3");n.textContent=e("killmail.engagementDetailsTitle","Engagement Details");const o=document.createElement("p");o.innerHTML=`<strong>${e("killmail.lossTypeLabel","Loss Type:")}</strong> ${l.loss_type}`;const a=document.createElement("p");a.innerHTML=`<strong>${e("killmail.timeLabel","Time:")}</strong> ${F(l.time_stamp,P)}`;const i=document.createElement("p"),m=document.createElement("span");return m.className="clickable-system",m.dataset.system=l.solar_system_name,m.title=e("tooltip.searchFor","Search for {itemName}",{itemName:l.solar_system_name}),m.textContent=l.solar_system_name,i.innerHTML=`<strong>${e("killmail.locationLabel","Location:")}</strong> `,i.appendChild(m),i.innerHTML+=` (${e("card.idLabel","ID:")} ${l.solar_system_id})`,t.appendChild(n),t.appendChild(o),t.appendChild(a),t.appendChild(i),t}function K(l,t,n){const o=document.createElement("details");o.className="fitting-category",o.setAttribute("open","");const a=document.createElement("summary");a.innerHTML=`<i class="fas fa-${t}"></i> ${l}`;const i=document.createElement("ul");return n.forEach(m=>{const r=document.createElement("li"),c=document.createElement("span");c.className="placeholder",c.textContent=m,r.appendChild(c),i.appendChild(r)}),o.appendChild(a),o.appendChild(i),o}function B(){const l=document.createElement("div");l.className="fitting-section-km data-card";const t=document.createElement("h3");t.textContent=e("killmail.fittingTitle","Ship Fitting & Contents");const n=document.createElement("p");n.className="note",n.innerHTML=`<i class="fas fa-info-circle"></i> ${e("killmail.fittingNote","Note: Fitting data is placeholder.")}`;const o=document.createElement("div");return o.className="fitting-table-km",[{title:e("killmail.fitting.highSlots","High Slots"),icon:"crosshairs",items:[e("killmail.placeholder.highSlotItem1","[High Slot Item 1]"),e("killmail.placeholder.highSlotItem2","[High Slot Item 2]"),e("killmail.placeholder.emptyHighSlot","[Empty High Slot]")]},{title:e("killmail.fitting.midSlots","Mid Slots"),icon:"shield-alt",items:[e("killmail.placeholder.midSlotItem1","[Mid Slot Item 1]"),e("killmail.placeholder.midSlotItem2","[Mid Slot Item 2]"),e("killmail.placeholder.midSlotItem3","[Mid Slot Item 3]")]},{title:e("killmail.fitting.lowSlots","Low Slots"),icon:"cogs",items:[e("killmail.placeholder.lowSlotItem1","[Low Slot Item 1]"),e("killmail.placeholder.lowSlotItem2","[Low Slot Item 2]"),e("killmail.placeholder.lowSlotItem3","[Low Slot Item 3]")]},{title:e("killmail.fitting.rigs","Rigs"),icon:"microchip",items:[e("killmail.placeholder.rigSlotItem1","[Rig Slot Item 1]"),e("killmail.placeholder.rigSlotItem2","[Rig Slot Item 2]"),e("killmail.placeholder.rigSlotItem3","[Rig Slot Item 3]")]},{title:e("killmail.fitting.drones","Drones"),icon:"fighter-jet",items:[e("killmail.placeholder.droneItem1","[Drone Item 1]"),e("killmail.placeholder.droneItem2","[Drone Item 2]")]},{title:e("killmail.fitting.ammoCharges","Ammunition / Charges"),icon:"cubes",items:[e("killmail.placeholder.ammoItem1","[Ammo Item 1]"),e("killmail.placeholder.ammoItem2","[Ammo Item 2]"),e("killmail.placeholder.ammoItem3","[Ammo Item 3]")]},{title:e("killmail.fitting.cargoHold","Cargo Hold"),icon:"box-open",items:[e("killmail.placeholder.cargoItem1","[Cargo Item 1]"),e("killmail.placeholder.cargoItem2","[Cargo Item 2]"),e("killmail.placeholder.cargoItem3","[Cargo Item 3]")]}].forEach(i=>{o.appendChild(K(i.title,i.icon,i.items))}),l.appendChild(t),l.appendChild(n),l.appendChild(o),l}function T(l){const t=document.getElementById("killmail-content"),n=document.getElementById("killmail-page-title-container"),o=document.querySelector("title");if(!t||!n||!o){console.error("One or more essential DOM elements for killmail detail page are missing."),t&&(t.innerHTML=`<p class="error">${e("error.generic","An error occurred.")}</p>`);return}if(!l){t.innerHTML=`<p class="error">${e("error.killmailLoadFailed","Killmail data is not available to render.")}</p>`;return}const a=u(l.victim_name,"unknown"),i=u(l.killer_name,"notApplicable"),m=u(l.solar_system_name,"unknown"),r=u(l.loss_type,"classified");u(l.solar_system_id,"notApplicable"),o.textContent=e("killmail.pageTitlePattern","Killmail: {killerName} vs {victimName}",{killerName:i,victimName:a});const c=document.createElement("h1"),s=document.createElement("span");s.className="killer clickable-name",s.dataset.name=i,s.title=e("tooltip.searchFor","Search for {itemName}",{itemName:i}),s.textContent=i;const h=document.createElement("span");h.className="text-primary",h.textContent=` ${e("killmail.headerVs","vs")} `;const p=document.createElement("span");p.className="victim clickable-name",p.dataset.name=a,p.title=e("tooltip.searchFor","Search for {itemName}",{itemName:a}),p.textContent=a,c.appendChild(s),c.appendChild(h),c.appendChild(p);const k=document.createElement("p");k.className="system-location";const b=document.createTextNode(`${e("killmail.headerIncidentIn","Incident in")} `),g=document.createElement("span");g.className="clickable-system",g.dataset.system=m,g.title=e("tooltip.searchFor","Search for {itemName}",{itemName:m}),g.textContent=m,k.appendChild(b),k.appendChild(g),n.innerHTML="",n.appendChild(c),n.appendChild(k);const f=document.createElement("div");f.className="combatants-grid-km";const w={name:i,loss_type:r},y={name:a,loss_type:r};f.appendChild(E(w,"killer")),f.appendChild(E(y,"victim"));const _=R(l),H=B();t.innerHTML="",t.appendChild(f),t.appendChild(_),t.appendChild(H),typeof L=="function"&&L()}async function N(){const t=new URLSearchParams(window.location.search).get("mail_id"),n=document.getElementById("killmail-content");if(!n){console.error("killmail-content element not found in DOM.");return}if(t)try{if(!d||d.id!==Number.parseInt(t)){const a=await D(t);if(!a||a.length===0)throw C(),new Error(e("error.killmailNotFound","Killmail not found."));d=a[0]}T(d)}catch(a){console.error("Failed to load killmail data from API:",a),d=null,n.innerHTML=`<p class="error">${e("error.killmailLoadFailedApi",a.message||"Failed to load killmail data from API.")}</p>`}else d=null,n.innerHTML=`<p class="error">${e("error.noKillmailId","No killmail ID provided in URL.")}</p>`;const o=localStorage.getItem("preferredLanguage")||$[0];typeof I=="function"&&I(o),C()}document.addEventListener("DOMContentLoaded",async()=>{M(),await v(),x("killmail_detail"),await N(),typeof window.AlphaStrike>"u"&&(window.AlphaStrike={}),window.AlphaStrike.onLanguageChangeRenderContent=()=>{console.log("Killmail page: Language change detected, re-rendering content."),d?T(d):N()}});
