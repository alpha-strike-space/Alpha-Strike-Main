import{n as F,m as S,l as _,s as L,t as N,a as E,h as H,o as M,p as A,q as P,j as R,k as K,i as B}from"./common-MNa96gSX.js";let p=null;const e=(t,l="",a={})=>{var n,m;const o=_[H];let i=((n=N[t])==null?void 0:n[o])||((m=N[t])==null?void 0:m.en)||l||t;for(const s in a)i=i.replace(new RegExp(`{${s}}`,"g"),a[s]);return i},I=(t,l)=>t==null||typeof t=="string"&&t.trim()===""?e(`general.${l.toLowerCase()}`,l):String(t);function b(t,l){const a=document.createElement("div");a.className=`combatant-column-km ${l}-column`;const o=document.createElement("div");o.className=`combatant-card-km ${l}-card-km`;const i=document.createElement("div");i.className="combatant-header-km";const n=document.createElement("img");n.className="profile-image",n.alt=e(`altText.${l}Image`,`${l} ${t.name}`,{name:t.name}),n.src=M(t.portrait_url,"../");const m=document.createElement("div");m.className="combatant-info-km";const s=document.createElement("h3");s.className=`combatant-role-label ${l}`,s.textContent=e(`killmail.${l}Label`,l.toUpperCase());const c=document.createElement("h2");c.className=`${l} clickable-name`,c.dataset.name=t.name,c.title=e("tooltip.searchFor","Search for {itemName}",{itemName:t.name}),c.textContent=t.name;const r=document.createElement("p");r.className=`${l} clickable-tribe`,r.dataset.tribe=t.tribe_name,r.title=e("tooltip.searchFor","Search for {itemName}",{itemName:t.tribe_name}),r.innerHTML=`${e("killmail.tribeLabel","Tribe:")} ${t.tribe_name}`;const d=document.createElement("p"),h=l==="victim"&&(t.loss_type==="ship"||t.loss_type==="pod")?t.loss_type:e(`killmail.placeholder.${l}Ship`,`[${l} Ship Placeholder]`);return d.innerHTML=`${e("killmail.shipLabel","Ship:")} <span class="placeholder">${h}</span>`,m.appendChild(s),m.appendChild(c),m.appendChild(r),m.appendChild(d),i.appendChild(n),i.appendChild(m),o.appendChild(i),a.appendChild(o),a}function O(t){const l=document.createElement("div");l.className="engagement-details-km data-card";const a=document.createElement("h3");a.textContent=e("killmail.engagementDetailsTitle","Engagement Details");const o=document.createElement("p");o.innerHTML=`<strong>${e("killmail.lossTypeLabel","Loss Type:")}</strong> ${t.loss_type}`;const i=document.createElement("p");i.innerHTML=`<strong>${e("killmail.timeLabel","Time:")}</strong> ${A(t.time_stamp,P)}`;const n=document.createElement("p"),m=document.createElement("span");return m.className="clickable-system",m.dataset.system=t.solar_system_name,m.title=e("tooltip.searchFor","Search for {itemName}",{itemName:t.solar_system_name}),m.textContent=t.solar_system_name,n.innerHTML=`<strong>${e("killmail.locationLabel","Location:")}</strong> `,n.appendChild(m),n.innerHTML+=` (${e("card.idLabel","ID:")} ${t.solar_system_id})`,l.appendChild(a),l.appendChild(o),l.appendChild(i),l.appendChild(n),l}function U(t,l,a){const o=document.createElement("details");o.className="fitting-category",o.setAttribute("open","");const i=document.createElement("summary");i.innerHTML=`<i class="fas fa-${l}"></i> ${t}`;const n=document.createElement("ul"),m=document.createDocumentFragment();return a.forEach(s=>{const c=document.createElement("li"),r=document.createElement("span");r.className="placeholder",r.textContent=s,c.appendChild(r),m.appendChild(c)}),n.appendChild(m),o.appendChild(i),o.appendChild(n),o}function j(){const t=document.createElement("div");t.className="fitting-section-km data-card";const l=document.createElement("h3");l.textContent=e("killmail.fittingTitle","Ship Fitting & Contents");const a=document.createElement("p");a.className="note",a.innerHTML=`<i class="fas fa-info-circle"></i> ${e("killmail.fittingNote","Note: Fitting data is placeholder.")}`;const o=document.createElement("div");return o.className="fitting-table-km",[{title:e("killmail.fitting.highSlots","High Slots"),icon:"crosshairs",items:[e("killmail.placeholder.highSlotItem1","[High Slot Item 1]"),e("killmail.placeholder.highSlotItem2","[High Slot Item 2]"),e("killmail.placeholder.emptyHighSlot","[Empty High Slot]")]},{title:e("killmail.fitting.midSlots","Mid Slots"),icon:"shield-alt",items:[e("killmail.placeholder.midSlotItem1","[Mid Slot Item 1]"),e("killmail.placeholder.midSlotItem2","[Mid Slot Item 2]"),e("killmail.placeholder.midSlotItem3","[Mid Slot Item 3]")]},{title:e("killmail.fitting.lowSlots","Low Slots"),icon:"cogs",items:[e("killmail.placeholder.lowSlotItem1","[Low Slot Item 1]"),e("killmail.placeholder.lowSlotItem2","[Low Slot Item 2]"),e("killmail.placeholder.lowSlotItem3","[Low Slot Item 3]")]},{title:e("killmail.fitting.rigs","Rigs"),icon:"microchip",items:[e("killmail.placeholder.rigSlotItem1","[Rig Slot Item 1]"),e("killmail.placeholder.rigSlotItem2","[Rig Slot Item 2]"),e("killmail.placeholder.rigSlotItem3","[Rig Slot Item 3]")]},{title:e("killmail.fitting.drones","Drones"),icon:"fighter-jet",items:[e("killmail.placeholder.droneItem1","[Drone Item 1]"),e("killmail.placeholder.droneItem2","[Drone Item 2]")]},{title:e("killmail.fitting.ammoCharges","Ammunition / Charges"),icon:"cubes",items:[e("killmail.placeholder.ammoItem1","[Ammo Item 1]"),e("killmail.placeholder.ammoItem2","[Ammo Item 2]"),e("killmail.placeholder.ammoItem3","[Ammo Item 3]")]},{title:e("killmail.fitting.cargoHold","Cargo Hold"),icon:"box-open",items:[e("killmail.placeholder.cargoItem1","[Cargo Item 1]"),e("killmail.placeholder.cargoItem2","[Cargo Item 2]"),e("killmail.placeholder.cargoItem3","[Cargo Item 3]")]}].forEach(n=>{o.appendChild(U(n.title,n.icon,n.items))}),t.appendChild(l),t.appendChild(a),t.appendChild(o),t}function $(t){const l=document.getElementById("killmail-content"),a=document.getElementById("killmail-page-title-container"),o=document.querySelector("title");if(!l||!a||!o){console.error("One or more essential DOM elements for killmail detail page are missing."),l&&(l.innerHTML=`<p class="error">${e("error.generic","An error occurred.")}</p>`);return}if(!t){l.innerHTML=`<p class="error">${e("error.killmailLoadFailed","Killmail data is not available to render.")}</p>`;return}const i=I(t.victim_name,"unknown"),n=I(t.killer_name,"notApplicable"),m=I(t.solar_system_name,"unknown"),s=I(t.loss_type,"classified");o.textContent=e("killmail.pageTitlePattern","Killmail: {killerName} vs {victimName}",{killerName:n,victimName:i});const c=document.createDocumentFragment(),r=document.createElement("h1"),d=document.createElement("span");d.className="killer clickable-name",d.dataset.name=n,d.title=e("tooltip.searchFor","Search for {itemName}",{itemName:n}),d.textContent=n;const h=document.createElement("span");h.className="text-primary",h.textContent=` ${e("killmail.headerVs","vs")} `;const g=document.createElement("span");g.className="victim clickable-name",g.dataset.name=i,g.title=e("tooltip.searchFor","Search for {itemName}",{itemName:i}),g.textContent=i,r.appendChild(d),r.appendChild(h),r.appendChild(g);const k=document.createElement("p");k.className="system-location";const w=document.createTextNode(`${e("killmail.headerIncidentIn","Incident in")} `),u=document.createElement("span");u.className="clickable-system",u.dataset.system=m,u.title=e("tooltip.searchFor","Search for {itemName}",{itemName:m}),u.textContent=m,k.appendChild(w),k.appendChild(u),c.appendChild(r),c.appendChild(k),a.textContent="",a.appendChild(c);const C=document.createDocumentFragment(),f=document.createElement("div");f.className="combatants-grid-km";const y={name:n,loss_type:s,tribe_name:t.killer_tribe_name,portrait_url:t.killer_portrait_url},v={name:i,loss_type:s,tribe_name:t.victim_tribe_name,portrait_url:t.victim_portrait_url};f.appendChild(b(y,"killer")),f.appendChild(b(v,"victim")),C.appendChild(f);const x=O(t);C.appendChild(x);const D=j();C.appendChild(D),l.textContent="",l.appendChild(C),typeof E=="function"&&E()}function q(){p?$(p):T()}async function T(){const l=new URLSearchParams(window.location.search).get("mail_id"),a=document.getElementById("killmail-content");if(!a){console.error("killmail-content element not found in DOM.");return}if(l)try{if(!p||p.id!==Number.parseInt(l)){const i=await F(l);if(!i||i.length===0)throw S(),new Error(e("error.killmailNotFound","Killmail not found."));p=i[0]}$(p)}catch(i){console.error("Failed to load killmail data from API:",i),p=null,a.innerHTML=`<p class="error">${e("error.killmailLoadFailedApi",i.message||"Failed to load killmail data from API.")}</p>`}else p=null,a.innerHTML=`<p class="error">${e("error.noKillmailId","No killmail ID provided in URL.")}</p>`;const o=localStorage.getItem("preferredLanguage")||_[0];typeof L=="function"&&L(o),S()}R();document.addEventListener("DOMContentLoaded",async()=>{await K(),B("killmail_detail"),await T(),typeof window.AlphaStrike>"u"&&(window.AlphaStrike={}),window.AlphaStrike.onLanguageChangeRenderContent=q,S()});
