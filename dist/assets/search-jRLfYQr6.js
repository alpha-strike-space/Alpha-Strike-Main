import{k as y,t as h,a as f,g as C,i as E,m as L,n as I,c as N,e as g}from"./api-dqlcaaWk.js";const p=(e,a="")=>{var n,s;const t=f[C];return((n=h[e])==null?void 0:n[t])||((s=h[e])==null?void 0:s.en)||a};function S(e){const a=e.total_losses>0?(e.total_kills/e.total_losses).toFixed(2):e.total_kills||0,t=(e.total_kills||0)+(e.total_losses||0),n=t>0?((e.total_kills||0)/t*100).toFixed(1):0;return{killDeathRatio:a,totalEngagements:t,winRate:n}}function D(e,a){const t=document.createElement("div");t.className="card-header";const n=document.createElement("div");n.className="profile-section";const s=document.createElement("div");s.className="profile-image-container";const c=document.createElement("img");c.className="profile-image",c.alt=`${e.name}'s profile`,c.src=e.image||"../assets/images/default-avatar.avif",s.appendChild(c);const d=document.createElement("div");d.className="profile-info";const l=document.createElement("h2");l.className="player-name",l.textContent=e.name;const o=document.createElement("p");o.className="player-status",o.textContent=e.status||p("general.unknown"),d.appendChild(l),d.appendChild(o),n.appendChild(s),n.appendChild(d);const r=document.createElement("div");r.className="header-stats";const i=document.createElement("div");i.className="header-stat",i.innerHTML=`
        <div class="header-stat-value ${a.killDeathRatio>1?"killer":"victim"}">${a.killDeathRatio}</div>
        <div class="header-stat-label" data-translate="card.kdRatio">K/D Ratio</div>
    `;const m=document.createElement("div");m.className="header-stat",m.innerHTML=`
        <div class="header-stat-value">${a.winRate}%</div>
        <div class="header-stat-label" data-translate="card.winRate">Win Rate</div>
    `;const u=document.createElement("div");return u.className="header-stat",u.innerHTML=`
        <div class="header-stat-value">${a.totalEngagements}</div>
        <div class="header-stat-label" data-translate="card.totalEngagements">Total Engagements</div>
    `,r.appendChild(i),r.appendChild(m),r.appendChild(u),t.appendChild(n),t.appendChild(r),t}function T(e){const a=e.incident_count&&e.days_active?(e.incident_count/e.days_active).toFixed(1):"< 1",t=e.incident_count>100?"HIGH":e.incident_count>50?"MEDIUM":"LOW";return{avgIncidentsPerDay:a,threatLevel:t,threatClass:t==="HIGH"?"threat-high":t==="MEDIUM"?"threat-medium":"threat-low",totalIncidents:e.incident_count||0,activeDays:e.days_active||0}}function _(e,a){const t=document.createElement("div");t.className="card-header";const n=document.createElement("div");n.className="system-section";const s=document.createElement("div");s.className="system-image-container";const c=document.createElement("img");c.className="system-image",c.alt=`${e.solar_system_name||e.name} system`,c.dataset.src="https://images.evetech.net/types/3796/render",s.appendChild(c);const d=document.createElement("div");d.className="system-info";const l=document.createElement("h2");l.className="system-name",l.textContent=e.solar_system_name||e.name;const o=document.createElement("p");o.className="system-region",o.textContent=e.region_name||e.region||p("general.unknown"),d.appendChild(l),d.appendChild(o),n.appendChild(s),n.appendChild(d);const r=document.createElement("div");r.className="header-stats";const i=document.createElement("div");i.className="header-stat",i.innerHTML=`
        <div class="header-stat-value ${a.threatClass}">${a.totalIncidents}</div>
        <div class="header-stat-label" data-translate="card.incidents">Incidents</div>
    `;const m=document.createElement("div");m.className="header-stat",m.innerHTML=`
        <div class="header-stat-value">${a.avgIncidentsPerDay}</div>
        <div class="header-stat-label" data-translate="card.avgPerDay">Per Day</div>
    `;const u=document.createElement("div");return u.className="header-stat",u.innerHTML=`
        <div class="header-stat-value">${a.activeDays}</div>
        <div class="header-stat-label" data-translate="card.activeDays">Active Days</div>
    `,r.appendChild(i),r.appendChild(m),r.appendChild(u),t.appendChild(n),t.appendChild(r),t}function H(e){const a=document.createElement("div");a.className="data-card enhanced-player-card",a.dataset.id=e.id;const t=S(e),n=D(e,t);return a.appendChild(n),a}function M(e){const a=document.createElement("div");a.className="data-card enhanced-system-card",a.dataset.id=e.id;const t=T(e),n=_(e,t);a.appendChild(n);const s=a.querySelector(".system-image");return s&&y.addLazyLoading(s,"https://images.evetech.net/types/3796/render"),a}function k(e,a){const t=document.getElementById("totals-card");if(t.innerHTML="",!e||e.length===0){t.innerHTML='<p data-translate="search.noAggregatedData">No aggregated data found.</p>';return}const n=e[0],s=a==="system"?M(n):H(n);t.appendChild(s)}function P(){const e=new URLSearchParams(window.location.search);return{query:e.get("query"),type:e.get("type")}}function R(){const{query:e,type:a}=P();if(e){const t=document.getElementById("searchQuery");t&&(t.value=decodeURIComponent(e))}if(a&&(a==="name"||a==="system")){const t=document.getElementById("searchType");t&&(t.value=a)}e&&a&&v(decodeURIComponent(e))}async function v(e){const a=document.getElementById("searchType").value,t=document.getElementById("results-container"),n=document.getElementById("totals-card");t.innerHTML='<p data-translate="search.loading">Loading...</p>',n.innerHTML="";try{const[s,c]=await Promise.all([L(e,a),I(e,a)]);k(c,a),w(s)}catch(s){console.error("Error fetching search data:",s),t.innerHTML='<p data-translate="search.error">Error loading search results.</p>'}if(typeof setLanguage=="function"){const s=localStorage.getItem("preferredLanguage")||"en";setLanguage(s)}}function w(e){const a=document.getElementById("results-container");if(a.innerHTML="",!e||e.length===0){a.innerHTML='<p data-translate="search.noResults">No results found.</p>';return}e.forEach(t=>{const n=N(t);n&&a.appendChild(n)}),typeof g=="function"&&g()}function B(){const e=document.getElementById("searchBtn"),a=document.getElementById("searchQuery");if(e.addEventListener("click",()=>{const t=a.value.trim();if(t===""){alert("Please enter a search query.");return}v(t)}),a.addEventListener("keypress",t=>{t.key==="Enter"&&e.click()}),R(),typeof setLanguage=="function"){const t=localStorage.getItem("preferredLanguage")||"en";setLanguage(t)}}document.addEventListener("DOMContentLoaded",()=>{E("search"),B()});
