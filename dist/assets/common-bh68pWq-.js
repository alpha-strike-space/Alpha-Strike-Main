(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function a(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=a(n);fetch(n.href,i)}})();function F(e){const t=document.getElementById("navigation-container");if(t){const r=window.location.pathname.endsWith("index.html")||window.location.pathname==="/"||window.location.pathname.endsWith("/Alpha-Strike-Main/")?"":"../";t.innerHTML=`
      <div class="topnav" id="myTopnav">
        <a href="${r}index.html" class="nav-logo alpha-strike-logo">
            Alpha-Strike
        </a>
        <button class="hamburger-menu" id="hamburgerBtn" aria-label="Toggle menu" aria-expanded="false" aria-controls="topnavLinks">
            <i class="fas fa-bars" aria-hidden="true"></i>
        </button>
        <div class="topnav-links" id="topnavLinks">
            <a ${e==="home"?'class="active"':""} href="${r}index.html"><i class="fa-sharp fa-solid fa-trophy"></i> <span data-translate="navbar.home">Recently Stamped</span></a>
            <a ${e==="killers"?'class="active"':""} href="${r}pages/killers.html"><i class="fa-solid fa-skull-crossbones"></i> <span data-translate="navbar.killers">Leading Killers</span></a>
            <a ${e==="victims"?'class="active"':""} href="${r}pages/victims.html"><i class="fa-solid fa-user-shield"></i> <span data-translate="navbar.victims">Leading Victims</span></a>
            <a ${e==="systems"?'class="active"':""} href="${r}pages/systems.html"><i class="fa-solid fa-map-location-dot"></i> <span data-translate="navbar.systems">Leading Systems</span></a>
            <div class="nav-search-container">
                <button id="navSearchToggle" class="nav-search-toggle" aria-label="Toggle search">
                    <i class="fa-solid fa-magnifying-glass"></i>
                </button>
                <div id="navSearchDropdown" class="nav-search-dropdown">
                    <div class="nav-search">
                        <select id="navSearchType">
                            <option value="name" data-translate="search.byName">Character</option>
                            <option value="system" data-translate="search.bySystem">System</option>
                        </select>
                        <input type="text" id="navSearchQuery" placeholder="Search..." data-translate="search.placeholder" />
                        <button id="navSearchBtn" aria-label="Search">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </button>
                    </div>
                </div>
            </div>
            <button id="animatedLangBtn" class="lang-btn-nav">EN</button>
        </div>
      </div>
    `;const n=document.getElementById("hamburgerBtn"),i=document.getElementById("topnavLinks"),s=document.getElementById("myTopnav"),o=n.querySelector("i");n&&i&&s&&o?n.addEventListener("click",()=>{i.classList.toggle("open"),s.classList.toggle("open");const l=i.classList.contains("open");n.setAttribute("aria-expanded",l.toString()),l?(o.classList.remove("fa-bars"),o.classList.add("fa-times")):(o.classList.remove("fa-times"),o.classList.add("fa-bars"))}):console.error("Hamburger menu elements not found. Navigation interactivity may be affected."),document.addEventListener("click",l=>{const h=document.querySelector(".nav-search-container"),u=document.getElementById("navSearchToggle"),p=document.getElementById("navSearchDropdown");h&&u&&p&&(h.contains(l.target)||p.classList.remove("show"))});const c=document.getElementById("navSearchToggle"),d=document.getElementById("navSearchDropdown");c&&d&&c.addEventListener("click",l=>{var h;l.stopPropagation(),d.classList.toggle("show"),d.classList.contains("show")&&((h=document.getElementById("navSearchQuery"))==null||h.focus())})}else console.error("Navigation container #navigation-container not found.")}let f={};const m=["en","es","ru","zh"];let y=0;function w(e){document.documentElement.lang=e,localStorage.setItem("preferredLanguage",e),[...document.querySelectorAll("[data-translate]")].map(n=>{const i=n.getAttribute("data-translate"),s=f[i],o=s&&(s[e]||s.en)||i;if(o)if(n.tagName==="INPUT"&&n.placeholder!==void 0&&(i.includes(".placeholder")||i.endsWith("Placeholder")))n.placeholder=o;else if(n.tagName==="BUTTON"||n.classList.contains("timezone-toggle-floating")){const c=n.querySelector("i"),d=n.querySelector("span[data-translate]");d&&d.getAttribute("data-translate")===i?d.textContent=o:c?n.innerHTML=`${c.outerHTML} ${o}`:n.textContent=o}else{const c=n.firstChild;c&&c.nodeType===Node.ELEMENT_NODE&&c.tagName==="I"?n.innerHTML=`${c.outerHTML} ${o}`:n.textContent=o}});const a=document.getElementById("animatedLangBtn");if(a){const n=a.querySelector("i.fa-globe"),i=n?`${n.outerHTML} `:"";a.innerHTML=`${i}${e.toUpperCase()}`}const r=m.indexOf(e);r!==-1&&(y=r),window.AlphaStrike&&typeof window.AlphaStrike.onLanguageChangeRenderContent=="function"&&(console.log("Calling window.AlphaStrike.onLanguageChangeRenderContent() due to language change."),window.AlphaStrike.onLanguageChangeRenderContent())}function X(){y=(y+1)%m.length;const e=m[y];w(e)}function W(){const e=document.getElementById("animatedLangBtn");if(e){const t=localStorage.getItem("preferredLanguage")||m[0],a=e.querySelector("i.fa-globe"),r=a?`${a.outerHTML} `:'<i class="fas fa-globe"></i> ';e.innerHTML=`${r}${t.toUpperCase()}`,e.addEventListener("click",X)}else console.warn("#animatedLangBtn not found during language switcher initialization.")}async function ee(){try{let e="";window.location.pathname.includes("/pages/")?e="../":(window.location.pathname.endsWith("/")||window.location.pathname.endsWith(".html"))&&(e="./");const t=await fetch(`${e}localization/translations.json`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status} for translations.json at ${e}localization/translations.json`);f=await t.json(),console.log("Translations loaded successfully.")}catch(e){console.error("Failed to load translations:",e),f={"error.loading":{en:"Error loading translations",es:"Error al cargar las traducciones",ru:"Ошибка загрузки переводов",zh:"加载翻译时出错"}}}}document.addEventListener("DOMContentLoaded",async()=>{await ee();const e=localStorage.getItem("preferredLanguage")||m[0],t=m.indexOf(e);t!==-1?y=t:y=0,w(m[y])});class te{constructor(){this.observer=null,this.init()}init(){"IntersectionObserver"in window&&(this.observer=new IntersectionObserver(t=>{t.forEach(a=>{if(a.isIntersecting){const r=a.target;r.dataset.src&&(r.src=r.dataset.src,r.removeAttribute("data-src")),this.observer.unobserve(r)}})},{rootMargin:"50px 0px",threshold:.01}))}addLazyLoading(t,a){this.observer?(t.dataset.src=a,t.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",this.observer.observe(t)):t.src=a}addLazyLoadingToImages(t){t.forEach(a=>{a.dataset.src&&this.addLazyLoading(a,a.dataset.src)})}testLazyLoading(){const t={intersectionObserverSupported:"IntersectionObserver"in window,observerInitialized:this.observer!==null,imagesObserved:0};if(this.observer){const a=document.querySelectorAll("img[data-src]");t.imagesObserved=a.length}return t.intersectionObserverSupported&&t.observerInitialized}}const j=new te;window.testLazyLoading=()=>j.testLazyLoading();let L=!0;function K(e,t=!0){let a;if(typeof e=="string")a=new Date(e);else if(typeof e=="number")if(e<1e10)a=new Date(e*1e3);else if(e<1e13)a=new Date(e);else{const h=e/1e4-116444736e5;a=new Date(h)}if(!a||Number.isNaN(a.getTime())||a.getFullYear()>2100||a.getFullYear()<1970)return console.warn("Invalid timestamp:",e),"INVALID TIMESTAMP";if(t){const d=a.getFullYear(),l=String(a.getMonth()+1).padStart(2,"0"),h=String(a.getDate()).padStart(2,"0"),u=String(a.getHours()).padStart(2,"0"),p=String(a.getMinutes()).padStart(2,"0"),g=String(a.getSeconds()).padStart(2,"0"),b=a.toLocaleTimeString("en-US",{timeZoneName:"short"}).split(" ")[2];return`${d}.${l}.${h} - ${u}:${p}:${g} ${b}`}const r=a.getUTCFullYear(),n=String(a.getUTCMonth()+1).padStart(2,"0"),i=String(a.getUTCDate()).padStart(2,"0"),s=String(a.getUTCHours()).padStart(2,"0"),o=String(a.getUTCMinutes()).padStart(2,"0"),c=String(a.getUTCSeconds()).padStart(2,"0");return`${r}.${n}.${i} - ${s}:${o}:${c} UTC`}function ae(){L=!L;const e=document.documentElement.lang||(typeof m<"u"?m[0]:"en");[...document.querySelectorAll(".timestamp-value")].map(n=>{const i=n.closest(".incident-list-item");i!=null&&i.dataset.timestamp&&(n.textContent=K(typeof i.dataset.timestamp=="string"&&!Number.isNaN(i.dataset.timestamp)?Number(i.dataset.timestamp):i.dataset.timestamp,L))});const a=document.getElementById("timezone-toggle");if(a){const n=a.querySelector("span[data-translate]");if(n){const i=L?"timezone.showUtc":"timezone.showLocal";n.setAttribute("data-translate",i);const s=f[i],o=s?s[e]:void 0;o?n.textContent=o:(n.textContent=s?s.en:i,console.warn(`Translation not found for key: ${i}, lang: ${e}. Using fallback.`))}}[...document.querySelectorAll(".timestamp-group .detail-label")].map(n=>{const i=L?"card.localTimeLabel":"card.utcTimeLabel";if(n.setAttribute("data-translate",i),typeof f<"u"&&f[i]&&f[i][e])n.textContent=f[i][e];else{let s=i.replace("card.","").replace("Label","");s=`${s.charAt(0).toUpperCase()+s.slice(1)} TIME:`,n.textContent=s,console.warn(`Translation not found for key: ${i}, lang: ${e}. Using fallback.`)}}),window.AlphaStrike&&typeof window.AlphaStrike.onLanguageChangeRenderContent=="function"&&(console.log("ToggleTimezone: Calling page-specific render function."),window.AlphaStrike.onLanguageChangeRenderContent())}async function C(e){try{const t=await fetch(e);if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);return await t.json()}catch(t){throw console.error("Error fetching data:",t),t}}const ne="https://world-api-stillness.live.tech.evefrontier.com";async function S(e){if(!e)return Promise.resolve(null);const t=`${ne}/v2/smartcharacters/${e}`;try{const a=await C(t);return a||null}catch(a){return console.error(`Error fetching smart character by address ${e}:`,a),null}}async function be(e=20,t=0){const a=await C(`https://api.alpha-strike.space/incident?filter=month&limit=${e}&offset=${t}`);return!a||!Array.isArray(a)?[]:await Promise.all(a.map(async n=>{const i=S(n.killer_address),s=S(n.victim_address),[o,c]=await Promise.all([i,s]);return{...n,killer_id:o?o.id:null,victim_id:c?c.id:null,killer_portrait_url:o?o.portraitUrl:null,victim_portrait_url:c?c.portraitUrl:null}}))}async function xe(e){const t=await C(`https://api.alpha-strike.space/incident?mail_id=${e}`);if(!t||t.length===0)return null;const a=t[0],r=S(a.killer_address),n=S(a.victim_address),[i,s]=await Promise.all([r,n]);return[{...a,killer_id:i?i.id:null,victim_id:s?s.id:null,killer_portrait_url:i?i.portraitUrl:null,victim_portrait_url:s?s.portraitUrl:null}]}async function q(e,t,a,r){let n=t==="system"?`https://api.alpha-strike.space/incident?system=${encodeURIComponent(e)}`:`https://api.alpha-strike.space/incident?name=${encodeURIComponent(e)}`;r!==void 0&&(n+=`&limit=${a}&offset=${r}`);const i=await C(n);return!i||!Array.isArray(i)?[]:await Promise.all(i.map(async o=>{const c=S(o.killer_address),d=S(o.victim_address),[l,h]=await Promise.all([c,d]);return{...o,killer_id:l?l.id:null,victim_id:h?h.id:null,killer_portrait_url:l?l.portraitUrl:null,victim_portrait_url:h?h.portraitUrl:null}}))}async function Ee(e="month"){return await C(`https://api.alpha-strike.space/totals?filter=${e}`)}async function ke(e="week"){return await C(`https://api.alpha-strike.space/totals?filter=${e}`)}async function Ie(e="day"){return await C(`https://api.alpha-strike.space/totals?filter=${e}`)}async function re(e,t){const a=t==="system"?`https://api.alpha-strike.space/totals?system=${encodeURIComponent(e)}`:`https://api.alpha-strike.space/totals?name=${encodeURIComponent(e)}`;return await C(a)}function ie(e){let t;if(typeof e=="string")t=new Date(e);else if(typeof e=="number")if(e<1e10)t=new Date(e*1e3);else if(e<1e13)t=new Date(e);else{const d=e/1e4-116444736e5;t=new Date(d)}if(!t||Number.isNaN(t.getTime())||t.getFullYear()>2100||t.getFullYear()<1970)return"";const r=new Date-t;if(r<0)return"";const n=Math.floor(r/(1e3*60*60*24)),i=Math.floor(r%(1e3*60*60*24)/(1e3*60*60)),s=Math.floor(r%(1e3*60*60)/(1e3*60));return n>0?`${n}d ${i}h ago`:i>0?`${i}h ${s}m ago`:s>0?`${s}m ago`:"Just now"}function se(e){if(!e||typeof e!="object")return console.warn("Invalid item passed to createIncidentCard:",e),null;if(e.id===void 0||e.id===null)return console.warn("Skipping card creation for item missing 'id':",e),null;if(!e.killer_name&&!e.victim_name&&!e.loss_type&&!e.solar_system_name&&!e.time_stamp)return console.warn("Skipping card creation for effectively empty item:",e),null;const a=document.createElement("div");a.className="incident-list-item",a.dataset.timestamp=e.time_stamp;const r=window.location.pathname.endsWith("index.html")||window.location.pathname==="/"||window.location.pathname.endsWith("/Alpha-Strike-Main/"),n=r?"./":"../",i=r?"pages/":"",s=e.time_stamp?K(e.time_stamp,L):"N/A",o=e.time_stamp?ie(e.time_stamp):"",c=L?"card.localTimeLabel":"card.utcTimeLabel",d=P(e.killer_portrait_url,n),l=P(e.victim_portrait_url,n),h=localStorage.getItem("preferredLanguage")||"en";function u($,H={},J=""){var R,z;let k=J;typeof f<"u"&&((R=f[$])!=null&&R[h])?k=f[$][h]:typeof f<"u"&&((z=f[$])!=null&&z.en)&&(k=f[$].en);for(const O in H)k=k.replace(`{${O}}`,H[O]);return k}const p=e.killer_name||"UNKNOWN",g=e.victim_name||"UNKNOWN",b=e.solar_system_name||"UNKNOWN";let B="";const A=e.id,U=u("tooltip.viewKillmailDetails",{killmailId:A},`View details for killmail ${A}`);return B=`
      <div class="incident-detail-link-container">
          <a href="${i}killmail.html?mail_id=${encodeURIComponent(A)}"
             class="view-killmail-details-link icon-only-link"
             aria-label="${U}"
             title="${U}">
             <i class="fa-sharp fa-solid fa-arrow-up-right-from-square"></i>
          </a>
      </div>
  `,a.innerHTML=`
        <div class="incident-photos">
            <div class="photo-container killer-photo">
                <img src="${d}" alt="Aggressor" class="combatant-photo killer-image"/>
            </div>
            <div class="vs-indicator"><i class="fas fa-bolt"></i></div>
            <div class="photo-container victim-photo">
                <img src="${l}" alt="Victim" class="combatant-photo victim-image"/>
            </div>
        </div>
        <div class="incident-combatants">
            <div class="combatant-info killer-info">
                <span class="combatant-label" data-translate="card.aggressor"></span>
                <span class="combatant-name killer clickable-name" data-name="${p}" title="${u("tooltip.searchFor",{itemName:p},`Search for ${p}`)}">${p}<i class="fa-sharp fa-solid fa-arrow-up-right-from-square"></i></span>
            </div>
            <div class="combatant-info victim-info">
                <span class="combatant-label" data-translate="card.casualty"></span>
                <span class="combatant-name victim clickable-name" data-name="${g}" title="${u("tooltip.searchFor",{itemName:g},`Search for ${g}`)}">${g}<i class="fa-sharp fa-solid fa-arrow-up-right-from-square"></i></span>
            </div>
        </div>
        <div class="incident-details-compact">
            <div class="detail-group">
                <span class="detail-label" data-translate="card.lossType"></span>
                <span class="detail-value">${e.loss_type||"CLASSIFIED"}</span>
            </div>
            <div class="detail-group">
                <span class="detail-label" data-translate="card.location"></span>
                <span class="detail-value clickable-system" data-system="${b}" title="${u("tooltip.searchFor",{itemName:b},`Search for ${b}`)}">${b}<i class="fa-sharp fa-solid fa-arrow-up-right-from-square"></i></span>
            </div>
        </div>
        <div class="incident-timestamp">
            <div class="timestamp-group">
                <span class="detail-label timestamp-label" data-translate="${c}"></span>
                <span class="timestamp-value">${s}</span>
                ${o?`<span class="time-elapsed">${o}</span>`:""}
            </div>
        </div>
        ${B}
    `,a}function _(e,t){if(!e||e==="UNKNOWN"||e==="CLASSIFIED"){console.warn("Cannot search for empty, unknown, or classified values");return}const n=`${window.location.pathname.endsWith("index.html")||window.location.pathname==="/"||window.location.pathname.endsWith("/Alpha-Strike-Main/")?"pages/search.html":window.location.pathname.includes("/pages/")?"search.html":"../pages/search.html"}?query=${encodeURIComponent(e)}&type=${t}`;window.location.href=n}function I(){for(const e of document.querySelectorAll(".clickable-name"))e.dataset.listenerAttached||(e.addEventListener("click",t=>{t.preventDefault();const a=e.dataset.name;a&&a!=="UNKNOWN"&&_(a,"name")}),e.dataset.listenerAttached="true");for(const e of document.querySelectorAll(".clickable-system"))e.dataset.listenerAttached||(e.addEventListener("click",t=>{t.preventDefault();const a=e.dataset.system;a&&a!=="UNKNOWN"&&_(a,"system")}),e.dataset.listenerAttached="true")}const V=(e,t="")=>{var r,n;const a=m[y];return((r=f[e])==null?void 0:r[a])||((n=f[e])==null?void 0:n.en)||t};function oe(e){const t=e.total_losses>0?(e.total_kills/e.total_losses).toFixed(2):e.total_kills||0,a=(e.total_kills||0)+(e.total_losses||0),r=a>0?((e.total_kills||0)/a*100).toFixed(1):0;return{killDeathRatio:t,totalEngagements:a,winRate:r}}function le(e,t,a){const r=document.createElement("div");r.className="card-header";const n=document.createElement("div");n.className="profile-section";const i=document.createElement("div");i.className="profile-image-container";const s=document.createElement("img");s.className="profile-image",s.alt=`${e.name}'s profile`,s.src=P(a,"../"),i.appendChild(s);const o=document.createElement("div");o.className="profile-info";const c=document.createElement("h2");c.className="player-name",c.textContent=e.name;const d=document.createElement("p");d.className="player-status",d.textContent=e.status||V("general.unknown"),o.appendChild(c),o.appendChild(d),n.appendChild(i),n.appendChild(o);const l=document.createElement("div");l.className="header-stats";const h=document.createElement("div");h.className="header-stat",h.innerHTML=`
        <div class="header-stat-value ${t.killDeathRatio>1?"killer":"victim"}">${t.killDeathRatio}</div>
        <div class="header-stat-label" data-translate="card.kdRatio">K/D Ratio</div>
    `;const u=document.createElement("div");u.className="header-stat",u.innerHTML=`
        <div class="header-stat-value">${t.winRate}%</div>
        <div class="header-stat-label" data-translate="card.winRate">Win Rate</div>
    `;const p=document.createElement("div");return p.className="header-stat",p.innerHTML=`
        <div class="header-stat-value">${t.totalEngagements}</div>
        <div class="header-stat-label" data-translate="card.totalEngagements">Total Engagements</div>
    `,l.appendChild(h),l.appendChild(u),l.appendChild(p),r.appendChild(n),r.appendChild(l),r}function ce(e){const t=e.incident_count&&e.days_active?(e.incident_count/e.days_active).toFixed(1):"< 1",a=e.incident_count>100?"HIGH":e.incident_count>50?"MEDIUM":"LOW";return{avgIncidentsPerDay:t,threatLevel:a,threatClass:a==="HIGH"?"threat-high":a==="MEDIUM"?"threat-medium":"threat-low",totalIncidents:e.incident_count||0,activeDays:e.days_active||0}}function de(e,t){const a=document.createElement("div");a.className="card-header";const r=document.createElement("div");r.className="system-section";const n=document.createElement("div");n.className="system-image-container";const i=document.createElement("i");i.className="fa-solid fa-sun system-image",i.setAttribute("aria-label","system star"),n.appendChild(i);const s=document.createElement("div");s.className="system-info";const o=document.createElement("h2");o.className="system-name",o.textContent=e.solar_system_name||e.name;const c=document.createElement("p");c.className="system-region",c.textContent=e.region_name||e.region||V("general.unknown"),s.appendChild(o),s.appendChild(c),r.appendChild(n),r.appendChild(s);const d=document.createElement("div");d.className="header-stats";const l=document.createElement("div");l.className="header-stat",l.innerHTML=`
        <div class="header-stat-value ${t.threatClass}">${t.totalIncidents}</div>
        <div class="header-stat-label" data-translate="card.incidentCount">Incidents</div>
    `;const h=document.createElement("div");h.className="header-stat",h.innerHTML=`
        <div class="header-stat-value">${t.avgIncidentsPerDay}</div>
        <div class="header-stat-label" data-translate="card.avgPerDay">Per Day</div>
    `;const u=document.createElement("div");return u.className="header-stat",u.innerHTML=`
        <div class="header-stat-value">${t.activeDays}</div>
        <div class="header-stat-label" data-translate="card.activeDays">Active Days</div>
    `,d.appendChild(l),d.appendChild(h),d.appendChild(u),a.appendChild(r),a.appendChild(d),a}async function he(e){const t=document.createElement("div");t.className="data-card enhanced-player-card",t.dataset.id=e.id;let a=null;if(e.character_address){const i=await S(e.character_address);i&&(a=i.portraitUrl)}const r=oe(e),n=le(e,r,a);return t.appendChild(n),t}function ue(e){const t=document.createElement("div");t.className="data-card enhanced-system-card",t.dataset.id=e.id;const a=ce(e),r=de(e,a);t.appendChild(r);const n=t.querySelector(".system-image");return n&&j.addLazyLoading(n,"https://images.evetech.net/types/3796/render"),t}async function fe(e,t){const a=document.getElementById("totals-card");if(a.innerHTML="",!e||e.length===0){a.innerHTML='<p data-translate="search.noAggregatedData">No aggregated data found.</p>';return}const r=e[0],n=t==="system"?ue(r):await he(r);a.appendChild(n)}function me(){const e=m[y],t=f["loading.overlay"];return t&&(t[e]||t.en)||"Loading..."}function Y(e){let t=document.createElement("div");t.id="loading-overlay",t.className="sci-fi-loading-overlay";const a=`
<svg class="loader-svg" xmlns="http://www.w3.org/2000/svg" width="38" height="43" viewBox="0 0 38 43" fill="none">
<rect x="20.5" y="0.5" width="2" height="2" fill="currentColor"></rect><rect x="25.5" y="0.5" width="2" height="2" fill="currentColor"></rect><rect x="30.5" y="0.5" width="2" height="2" fill="currentColor"></rect><rect x="35.5" y="0.5" width="2" height="2" fill="currentColor"></rect><rect x="20.5" y="5.5" width="2" height="2" fill="currentColor"></rect><rect x="25.5" y="5.5" width="2" height="2" fill="currentColor"></rect><rect x="30.5" y="5.5" width="2" height="2" fill="currentColor"></rect><rect x="35.5" y="5.5" width="2" height="2" fill="currentColor"></rect><rect x="20.5" y="10.5" width="2" height="2" fill="currentColor"></rect><rect x="25.5" y="10.5" width="2" height="2" fill="currentColor"></rect><rect x="30.5" y="10.5" width="2" height="2" fill="currentColor"></rect><rect x="35.5" y="10.5" width="2" height="2" fill="currentColor"></rect><rect x="20.5" y="30.5" width="2" height="2" fill="currentColor"></rect><rect x="25.5" y="30.5" width="2" height="2" fill="currentColor"></rect><rect x="30.5" y="30.5" width="2" height="2" fill="currentColor"></rect><rect x="35.5" y="30.5" width="2" height="2" fill="currentColor"></rect><rect x="20.5" y="35.5" width="2" height="2" fill="currentColor"></rect><rect x="25.5" y="35.5" width="2" height="2" fill="currentColor"></rect><rect x="30.5" y="35.5" width="2" height="2" fill="currentColor"></rect><rect x="35.5" y="35.5" width="2" height="2" fill="currentColor"></rect><rect x="20.5" y="40.5" width="2" height="2" fill="currentColor"></rect><rect x="25.5" y="40.5" width="2" height="2" fill="currentColor"></rect><rect x="30.5" y="40.5" width="2" height="2" fill="currentColor"></rect><rect x="35.5" y="40.5" width="2" height="2" fill="currentColor"></rect><rect x="20.5" y="15.5" width="2" height="2" fill="currentColor"></rect><rect x="25.5" y="15.5" width="2" height="2" fill="currentColor"></rect><rect x="30.5" y="15.5" width="2" height="2" fill="currentColor"></rect><rect x="35.5" y="15.5" width="2" height="2" fill="currentColor"></rect><rect x="20.5" y="20.5" width="2" height="2" fill="currentColor"></rect><rect x="25.5" y="20.5" width="2" height="2" fill="currentColor"></rect><rect x="30.5" y="20.5" width="2" height="2" fill="currentColor"></rect><rect x="35.5" y="20.5" width="2" height="2" fill="currentColor"></rect><rect x="20.5" y="25.5" width="2" height="2" fill="currentColor"></rect><rect x="25.5" y="25.5" width="2" height="2" fill="currentColor"></rect><rect x="30.5" y="25.5" width="2" height="2" fill="currentColor"></rect><rect x="35.5" y="25.5" width="2" height="2" fill="currentColor"></rect><rect x="0.5" y="0.5" width="2" height="2" fill="currentColor"></rect><rect x="5.5" y="0.5" width="2" height="2" fill="currentColor"></rect><rect x="10.5" y="0.5" width="2" height="2" fill="currentColor"></rect><rect x="15.5" y="0.5" width="2" height="2" fill="currentColor"></rect><rect x="0.5" y="5.5" width="2" height="2" fill="currentColor"></rect><rect x="5.5" y="5.5" width="2" height="2" fill="currentColor"></rect><rect x="10.5" y="5.5" width="2" height="2" fill="currentColor"></rect><rect x="15.5" y="5.5" width="2" height="2" fill="currentColor"></rect><rect x="0.5" y="10.5" width="2" height="2" fill="currentColor"></rect><rect x="5.5" y="10.5" width="2" height="2" fill="currentColor"></rect><rect x="10.5" y="10.5" width="2" height="2" fill="currentColor"></rect><rect x="15.5" y="10.5" width="2" height="2" fill="currentColor"></rect><rect x="0.5" y="30.5" width="2" height="2" fill="currentColor"></rect><rect x="5.5" y="30.5" width="2" height="2" fill="currentColor"></rect><rect x="10.5" y="30.5" width="2" height="2" fill="currentColor"></rect><rect x="15.5" y="30.5" width="2" height="2" fill="currentColor"></rect><rect x="0.5" y="35.5" width="2" height="2" fill="currentColor"></rect><rect x="5.5" y="35.5" width="2" height="2" fill="currentColor"></rect><rect x="10.5" y="35.5" width="2" height="2" fill="currentColor"></rect><rect x="15.5" y="35.5" width="2" height="2" fill="currentColor"></rect><rect x="0.5" y="40.5" width="2" height="2" fill="currentColor"></rect><rect x="5.5" y="40.5" width="2" height="2" fill="currentColor"></rect><rect x="10.5" y="40.5" width="2" height="2" fill="currentColor"></rect><rect x="15.5" y="40.5" width="2" height="2" fill="currentColor"></rect><rect x="0.5" y="15.5" width="2" height="2" fill="currentColor"></rect><rect x="5.5" y="15.5" width="2" height="2" fill="currentColor"></rect><rect x="10.5" y="15.5" width="2" height="2" fill="currentColor"></rect><rect x="15.5" y="15.5" width="2" height="2" fill="currentColor"></rect><rect x="0.5" y="20.5" width="2" height="2" fill="currentColor"></rect><rect x="5.5" y="20.5" width="2" height="2" fill="currentColor"></rect><rect x="10.5" y="20.5" width="2" height="2" fill="currentColor"></rect><rect x="15.5" y="20.5" width="2" height="2" fill="currentColor"></rect><rect x="0.5" y="25.5" width="2" height="2" fill="currentColor"></rect><rect x="5.5" y="25.5" width="2" height="2" fill="currentColor"></rect><rect x="10.5" y="25.5" width="2" height="2" fill="currentColor"></rect><rect x="15.5" y="25.5" width="2" height="2" fill="currentColor"></rect>
</svg>`.trim(),r=Array(10).fill(a).join("");t.innerHTML=`
        <div class="sci-fi-loader">
            <div class="loader-svg-container">
                ${r}
            </div>
            <span class="loader-text" data-translate="loading.overlay">${me()}</span>
        </div>
    `,document.body.appendChild(t)}function Q(){const e=document.getElementById("loading-overlay");e&&e.remove()}function pe({container:e,currentPage:t,hasNextPage:a,onPageClick:r,totalPages:n=null}){if(!e)return;e.innerHTML="";const i=(l,h,u=!1,p=!1)=>{const g=document.createElement("button");return g.textContent=l,g.disabled=u,p&&g.classList.add("active"),g.addEventListener("click",()=>r(h)),g},s=n!==null?t<n:a;e.appendChild(i("«",t-1,t===1));const o=2;let c=Math.max(1,t-o),d;if(n?d=Math.min(n,t+o):d=t+o,c>1&&(e.appendChild(i("1",1)),c>2)){const l=document.createElement("span");l.textContent="...",e.appendChild(l)}for(let l=c;l<=d;l++)!n&&l>t&&!a||e.appendChild(i(l.toString(),l,!1,l===t));if(n&&d<n){if(d<n-1){const l=document.createElement("span");l.textContent="...",e.appendChild(l)}e.appendChild(i(n.toString(),n))}else if(!n&&a){const l=document.createElement("span");l.textContent="...",e.appendChild(l)}e.appendChild(i("»",t+1,!s))}const v=20;let x=1,E=!1,G="",Z="",T=0;function ge(){const e=new URLSearchParams(window.location.search);return{query:e.get("query"),type:e.get("type")}}function ye(){const e=document.getElementById("navSearchBtn"),t=document.getElementById("navSearchQuery"),a=document.getElementById("navSearchType");!e||!t||!a||(e.addEventListener("click",()=>{const r=t.value.trim();if(r===""){alert("Please enter a search query.");return}_(r,a.value)}),t.addEventListener("keypress",r=>{r.key==="Enter"&&e.click()}))}function ve(e,t){if(!e||!e.trim())return[];if(e=e.trim(),t==="system")return[e.toUpperCase()];const a=e.toLowerCase(),r=e.toUpperCase(),n=e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();return[...new Set([e,a,r,n])]}function D(e){const t=document.getElementById("results-container");if(t){if(t.innerHTML="",!e||e.length===0){t.innerHTML='<p data-translate="search.noResults">No search results found.</p>';return}e.forEach(a=>{const r=se(a);r&&t.appendChild(r)}),I==null||I()}}function N(){const e=document.getElementById("pagination-container");e&&(x>1||E?(e.style.display="flex",pe({container:e,currentPage:x,hasNextPage:E,onPageClick:we,totalPages:T>0?Math.ceil(T/v):null})):e.style.display="none")}async function we(e){Y();try{await M(e);const t=document.getElementById("results-container");t&&t.scrollIntoView({behavior:"smooth",block:"start"})}catch(t){console.error("Error fetching search page:",t),document.getElementById("results-container").innerHTML='<p data-translate="search.error">Error loading search results.</p>'}finally{Q();const t=localStorage.getItem("preferredLanguage")||"en";w(t)}}async function M(e){if(e<1){x=1,E=!1,D([]),N();return}try{const t=(e-1)*v,a=await q(G,Z,v+1,t);if(a.length===0&&e>1){await M(e-1);return}x=e,E=a.length>v;const r=a.slice(0,v);D(r),N()}catch(t){console.warn(`Failed to fetch search page ${e}, trying page ${e-1}. Error:`,t),e>1?await M(e-1):(console.error("Error fetching initial search results:",t),document.getElementById("results-container").innerHTML='<p data-translate="search.error">Error loading search results.</p>',x=1,E=!1,N())}}async function Ce(e,t){const a=document.getElementById("results-container"),r=document.getElementById("totals-card"),n=document.getElementById("pagination-container");if(!a||!r||!n)return;x=1,T=0,a.innerHTML='<p data-translate="search.loading">Loading...</p>',r.innerHTML="",n.style.display="none",Y();const i=ve(e,t);let s=null,o=[],c=[];for(const l of i)try{const[h,u]=await Promise.all([re(l,t),q(l,t,v+1,0)]);if((u==null?void 0:u.length)>0){s=l,o=u,c=h||[];break}}catch{}if(Q(),s){if(G=s,Z=t,c&&c.length>0){const h=c[0];t==="system"?T=h.incident_count||0:T=(h.total_kills||0)+(h.total_losses||0)}await fe(c,t),E=o.length>v;const l=o.slice(0,v);D(l),N()}else a.innerHTML='<p data-translate="search.noResults">No results found for your query.</p>';const d=localStorage.getItem("preferredLanguage")||"en";w(d)}function Te(){const{query:e,type:t}=ge();e&&Ce(decodeURIComponent(e),t||"name")}const Le={"https://artifacts.evefrontier.com/portraits/PortraitAwakened256.png":"assets/images/portraits/PortraitAwakened256.avif","https://artifacts.evefrontier.com/portraits/PortraitAscended256.png":"assets/images/portraits/PortraitAscended256.avif","https://artifacts.evefrontier.com/portraits/PortraitRainmakers256.png":"assets/images/portraits/PortraitRainmakers256.avif","https://artifacts.evefrontier.com/portraits/PortraitInitiated256.png":"assets/images/portraits/PortraitInitiated256.avif","https://artifacts.evefrontier.com/Character/123456789_256.jpg":"assets/images/portraits/123456789_256.avif","https://artifacts.evefrontier.com/portraits/PortraitSeers256.png":"assets/images/portraits/PortraitSeers256.avif","https://artifacts.evefrontier.com/portraits/PortraitHarbingers256.png":"assets/images/portraits/PortraitHarbingers256.avif"};function P(e,t){const a=`${t}assets/images/default-avatar.avif`;if(!e)return a;const r=Le[e];return r?t+r:(console.warn(`Missing local mapping for portrait URL: "${e}". Using default avatar. Please download the image and update the portraitUrlMapping in js/common.js.`),a)}function $e(e){if(typeof F=="function")F(e);else{console.error("initializeNavigation function is not defined. Ensure components/navigation.js is loaded.");return}typeof W=="function"?W():console.error("initializeLanguageSwitcher function not found. Ensure translation-dictionary.js is loaded correctly and defines it.");const t=document.getElementById("timezone-toggle");if(t&&(t.hasAttribute("data-listener-attached")||(t.addEventListener("click",ae),t.setAttribute("data-listener-attached","true"))),typeof w=="function"&&typeof m<"u"&&m.length>0){const a=localStorage.getItem("preferredLanguage")||m[0];w(a)}else console.error("setLanguage function or languages array not found. Translation system might not be fully initialized.");ye()}function Ne(e,t,a,r={}){const n=document.getElementById(t);if(!n){console.error(`Container with ID ${t} not found`);return}if(n.innerHTML="",!e||e.length===0){n.textContent=r.noDataMessage||"No data available.";return}r.sortBy&&r.sortDirection&&e.sort((s,o)=>{const c=s&&typeof s=="object"&&Object.prototype.hasOwnProperty.call(s,r.sortBy)?s[r.sortBy]:void 0,d=o&&typeof o=="object"&&Object.prototype.hasOwnProperty.call(o,r.sortBy)?o[r.sortBy]:void 0;if(c==null)return r.sortDirection==="desc"?1:-1;if(d==null)return r.sortDirection==="desc"?-1:1;let l=0;return c>d?l=1:c<d&&(l=-1),r.sortDirection==="desc"?l*-1:l});let i=e;if(r.limit&&(i=e.slice(0,r.limit)),[...i].map(s=>{const o=a(s);o?n.appendChild(o):console.warn("Skipping invalid card for item:",s)}),typeof I=="function"&&I(),typeof w=="function"&&typeof m<"u"&&m.length>0){const s=localStorage.getItem("preferredLanguage")||m[0];w(s)}}export{I as a,Y as b,se as c,Ne as d,xe as e,be as f,m as g,Q as h,$e as i,y as j,P as k,ee as l,K as m,L as n,Te as o,Ie as p,ke as q,pe as r,w as s,f as t,Ee as u,_ as v};
