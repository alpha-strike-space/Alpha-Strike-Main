(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();function z(e){const a=document.getElementById("navigation-container");if(a){const i=window.location.pathname.endsWith("index.html")||window.location.pathname==="/"||window.location.pathname.endsWith("/Alpha-Strike-Main/")?"":"../";a.innerHTML=`
      <div class="topnav" id="myTopnav">
        <a href="${i}index.html" class="nav-logo alpha-strike-logo">
            Alpha-Strike
        </a>
        <button class="hamburger-menu" id="hamburgerBtn" aria-label="Toggle menu" aria-expanded="false" aria-controls="topnavLinks">
            <i class="fas fa-bars" aria-hidden="true"></i>
        </button>
        <div class="topnav-links" id="topnavLinks">
            <a ${e==="home"?'class="active"':""} href="${i}index.html"><i class="fa-sharp fa-solid fa-trophy"></i> <span data-translate="navbar.home">Recently Stamped</span></a>
            <a ${e==="killers"?'class="active"':""} href="${i}pages/killers.html"><i class="fa-solid fa-skull-crossbones"></i> <span data-translate="navbar.killers">Leading Killers</span></a>
            <a ${e==="victims"?'class="active"':""} href="${i}pages/victims.html"><i class="fa-solid fa-user-shield"></i> <span data-translate="navbar.victims">Leading Victims</span></a>
            <a ${e==="systems"?'class="active"':""} href="${i}pages/systems.html"><i class="fa-solid fa-map-location-dot"></i> <span data-translate="navbar.systems">Leading Systems</span></a>
            <a ${e==="search"?'class="active"':""} href="${i}pages/search.html"><i class="fa-solid fa-magnifying-glass"></i> <span data-translate="navbar.search">Search</span></a>
            <button id="animatedLangBtn" class="lang-btn-nav">EN</button>
        </div>
      </div>
    `;const n=document.getElementById("hamburgerBtn"),s=document.getElementById("topnavLinks"),o=document.getElementById("myTopnav"),r=n.querySelector("i");n&&s&&o&&r?n.addEventListener("click",()=>{s.classList.toggle("open"),o.classList.toggle("open");const l=s.classList.contains("open");n.setAttribute("aria-expanded",l.toString()),l?(r.classList.remove("fa-bars"),r.classList.add("fa-times")):(r.classList.remove("fa-times"),r.classList.add("fa-bars"))}):console.error("Hamburger menu elements not found. Navigation interactivity may be affected.")}else console.error("Navigation container #navigation-container not found.")}let f={};const d=["en","es","ru","zh"];let m=0;function w(e){document.documentElement.lang=e,localStorage.setItem("preferredLanguage",e),[...document.querySelectorAll("[data-translate]")].map(n=>{const s=n.getAttribute("data-translate"),o=f[s],r=o&&(o[e]||o.en)||s;if(r)if(n.tagName==="INPUT"&&n.placeholder!==void 0&&(s.includes(".placeholder")||s.endsWith("Placeholder")))n.placeholder=r;else if(n.tagName==="BUTTON"||n.classList.contains("timezone-toggle-floating")){const l=n.querySelector("i"),c=n.querySelector("span[data-translate]");c&&c.getAttribute("data-translate")===s?c.textContent=r:l?n.innerHTML=`${l.outerHTML} ${r}`:n.textContent=r}else{const l=n.firstChild;l&&l.nodeType===Node.ELEMENT_NODE&&l.tagName==="I"?n.innerHTML=`${l.outerHTML} ${r}`:n.textContent=r}});const t=document.getElementById("animatedLangBtn");if(t){const n=t.querySelector("i.fa-globe"),s=n?`${n.outerHTML} `:"";t.innerHTML=`${s}${e.toUpperCase()}`}const i=d.indexOf(e);i!==-1&&(m=i),window.AlphaStrike&&typeof window.AlphaStrike.onLanguageChangeRenderContent=="function"&&(console.log("Calling window.AlphaStrike.onLanguageChangeRenderContent() due to language change."),window.AlphaStrike.onLanguageChangeRenderContent())}function U(){m=(m+1)%d.length;const e=d[m];w(e)}function x(){const e=document.getElementById("animatedLangBtn");if(e){const a=localStorage.getItem("preferredLanguage")||d[0],t=e.querySelector("i.fa-globe"),i=t?`${t.outerHTML} `:'<i class="fas fa-globe"></i> ';e.innerHTML=`${i}${a.toUpperCase()}`,e.addEventListener("click",U)}else console.warn("#animatedLangBtn not found during language switcher initialization.")}async function P(){try{let e="";window.location.pathname.includes("/pages/")?e="../":(window.location.pathname.endsWith("/")||window.location.pathname.endsWith(".html"))&&(e="./");const a=await fetch(`${e}localization/translations.json`);if(!a.ok)throw new Error(`HTTP error! status: ${a.status} for translations.json at ${e}localization/translations.json`);f=await a.json(),console.log("Translations loaded successfully.")}catch(e){console.error("Failed to load translations:",e),f={"error.loading":{en:"Error loading translations",es:"Error al cargar las traducciones",ru:"Ошибка загрузки переводов",zh:"加载翻译时出错"}}}}document.addEventListener("DOMContentLoaded",async()=>{await P();const e=localStorage.getItem("preferredLanguage")||d[0],a=d.indexOf(e);a!==-1?m=a:m=0,w(d[m])});class H{constructor(){this.observer=null,this.init()}init(){"IntersectionObserver"in window?(console.log("LazyLoader: IntersectionObserver is supported"),this.observer=new IntersectionObserver(a=>{a.forEach(t=>{if(t.isIntersecting){const i=t.target;i.dataset.src&&(console.log("LazyLoader: Loading image",i.dataset.src),i.src=i.dataset.src,i.removeAttribute("data-src")),this.observer.unobserve(i)}})},{rootMargin:"50px 0px",threshold:.01})):console.log("LazyLoader: IntersectionObserver not supported, using fallback")}addLazyLoading(a,t){this.observer?(console.log("LazyLoader: Setting up lazy loading for",t),a.dataset.src=t,a.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",this.observer.observe(a)):(console.log("LazyLoader: Using fallback loading for",t),a.src=t)}addLazyLoadingToImages(a){a.forEach(t=>{console.log("Adding lazy loading to image",t.dataset.src),t.dataset.src&&(this.addLazyLoading(t,t.dataset.src),console.log("Added lazy loading to image",t.dataset.src))})}testLazyLoading(){const a={intersectionObserverSupported:"IntersectionObserver"in window,observerInitialized:this.observer!==null,imagesObserved:0};if(this.observer){const t=document.querySelectorAll("img[data-src]");a.imagesObserved=t.length}return console.log("Lazy Loading Test Results:",a),a.intersectionObserverSupported&&a.observerInitialized}}const k=new H;window.testLazyLoading=()=>k.testLazyLoading();let g=!0;function B(e,a=!0){let t;if(typeof e=="string")t=new Date(e);else if(typeof e=="number")if(e<1e10)t=new Date(e*1e3);else if(e<1e13)t=new Date(e);else{const u=e/1e4-116444736e5;t=new Date(u)}if(!t||Number.isNaN(t.getTime())||t.getFullYear()>2100||t.getFullYear()<1970)return console.warn("Invalid timestamp:",e),"INVALID TIMESTAMP";if(a){const c=t.getFullYear(),p=String(t.getMonth()+1).padStart(2,"0"),u=String(t.getDate()).padStart(2,"0"),y=String(t.getHours()).padStart(2,"0"),v=String(t.getMinutes()).padStart(2,"0"),L=String(t.getSeconds()).padStart(2,"0"),S=t.toLocaleTimeString("en-US",{timeZoneName:"short"}).split(" ")[2];return`${c}.${p}.${u} - ${y}:${v}:${L} ${S}`}const i=t.getUTCFullYear(),n=String(t.getUTCMonth()+1).padStart(2,"0"),s=String(t.getUTCDate()).padStart(2,"0"),o=String(t.getUTCHours()).padStart(2,"0"),r=String(t.getUTCMinutes()).padStart(2,"0"),l=String(t.getUTCSeconds()).padStart(2,"0");return`${i}.${n}.${s} - ${o}:${r}:${l} UTC`}function _(){g=!g;const e=document.documentElement.lang||(typeof d<"u"?d[0]:"en");[...document.querySelectorAll(".timestamp-value")].map(n=>{const s=n.closest(".incident-list-item");s!=null&&s.dataset.timestamp&&(n.textContent=B(typeof s.dataset.timestamp=="string"&&!Number.isNaN(s.dataset.timestamp)?Number(s.dataset.timestamp):s.dataset.timestamp,g))});const t=document.getElementById("timezone-toggle");if(t){const n=t.querySelector("span[data-translate]");if(n){const s=g?"timezone.showUtc":"timezone.showLocal";n.setAttribute("data-translate",s);const o=f[s],r=o?o[e]:void 0;r?n.textContent=r:(n.textContent=o?o.en:s,console.warn(`Translation not found for key: ${s}, lang: ${e}. Using fallback.`))}}[...document.querySelectorAll(".timestamp-group .detail-label")].map(n=>{const s=g?"card.localTimeLabel":"card.utcTimeLabel";if(n.setAttribute("data-translate",s),typeof f<"u"&&f[s]&&f[s][e])n.textContent=f[s][e];else{let o=s.replace("card.","").replace("Label","");o=`${o.charAt(0).toUpperCase()+o.slice(1)} TIME:`,n.textContent=o,console.warn(`Translation not found for key: ${s}, lang: ${e}. Using fallback.`)}}),window.AlphaStrike&&typeof window.AlphaStrike.onLanguageChangeRenderContent=="function"&&(console.log("ToggleTimezone: Calling page-specific render function."),window.AlphaStrike.onLanguageChangeRenderContent())}function R(e){let a;if(typeof e=="string")a=new Date(e);else if(typeof e=="number")if(e<1e10)a=new Date(e*1e3);else if(e<1e13)a=new Date(e);else{const c=e/1e4-116444736e5;a=new Date(c)}if(!a||Number.isNaN(a.getTime())||a.getFullYear()>2100||a.getFullYear()<1970)return"";const i=new Date-a;if(i<0)return"";const n=Math.floor(i/(1e3*60*60*24)),s=Math.floor(i%(1e3*60*60*24)/(1e3*60*60)),o=Math.floor(i%(1e3*60*60)/(1e3*60));return n>0?`${n}d ${s}h ago`:s>0?`${s}h ${o}m ago`:o>0?`${o}m ago`:"Just now"}function W(e){if(!e||typeof e!="object")return console.warn("Invalid item passed to createIncidentCard:",e),null;if(e.id===void 0||e.id===null)return console.warn("Skipping card creation for item missing 'id':",e),null;if(!e.killer_name&&!e.victim_name&&!e.loss_type&&!e.solar_system_name&&!e.time_stamp)return console.warn("Skipping card creation for effectively empty item:",e),null;const t=document.createElement("div");t.className="incident-list-item",t.dataset.timestamp=e.time_stamp;const i=document.createElement("img");i.className="profile-image",i.alt=`Killer ${e.killer_name||"Unknown"}`,i.dataset.src="../assets/images/default-avatar.avif",k.addLazyLoading(i,i.dataset.src);const n=document.createElement("img");n.className="profile-image",n.alt=`Victim ${e.victim_name||"Unknown"}`,n.dataset.src="../assets/images/default-avatar.avif",k.addLazyLoading(n,n.dataset.src);const o=window.location.pathname.endsWith("index.html")||window.location.pathname==="/"||window.location.pathname.endsWith("/Alpha-Strike-Main/")?"pages/":"",r=e.time_stamp?B(e.time_stamp,g):"N/A",l=e.time_stamp?R(e.time_stamp):"",c=g?"card.localTimeLabel":"card.utcTimeLabel",p=localStorage.getItem("preferredLanguage")||"en";function u($,I={},O=""){var N,E;let b=O;typeof f<"u"&&((N=f[$])!=null&&N[p])?b=f[$][p]:typeof f<"u"&&((E=f[$])!=null&&E.en)&&(b=f[$].en);for(const C in I)b=b.replace(`{${C}}`,I[C]);return b}const y=e.killer_name||"UNKNOWN",v=e.victim_name||"UNKNOWN",L=e.solar_system_name||"UNKNOWN";let S="";const T=e.id,A=u("tooltip.viewKillmailDetails",{killmailId:T},`View details for killmail ${T}`);return S=`
      <div class="incident-detail-link-container">
          <a href="${o}killmail.html?mail_id=${encodeURIComponent(T)}"
             class="view-killmail-details-link icon-only-link"
             aria-label="${A}"
             title="${A}">
             <i class="fa-sharp fa-solid fa-arrow-up-right-from-square"></i>
          </a>
      </div>
  `,t.innerHTML=`
        <div class="incident-photos">
            <div class="photo-container killer-photo">
                <img src="${i.dataset.src}" alt="Aggressor" class="combatant-photo"/>
            </div>
            <div class="vs-indicator"><i class="fas fa-bolt"></i></div>
            <div class="photo-container victim-photo">
                <img src="${n.dataset.src}" alt="Victim" class="combatant-photo"/>
            </div>
        </div>
        <div class="incident-combatants">
            <div class="combatant-info killer-info">
                <span class="combatant-label" data-translate="card.aggressor"></span>
                <span class="combatant-name killer clickable-name" data-name="${y}" title="${u("tooltip.searchFor",{itemName:y},`Search for ${y}`)}">${y}<i class="fa-sharp fa-solid fa-arrow-up-right-from-square"></i></span>
            </div>
            <div class="combatant-info victim-info">
                <span class="combatant-label" data-translate="card.casualty"></span>
                <span class="combatant-name victim clickable-name" data-name="${v}" title="${u("tooltip.searchFor",{itemName:v},`Search for ${v}`)}">${v}<i class="fa-sharp fa-solid fa-arrow-up-right-from-square"></i></span>
            </div>
        </div>
        <div class="incident-details-compact">
            <div class="detail-group">
                <span class="detail-label" data-translate="card.lossType"></span>
                <span class="detail-value">${e.loss_type||"CLASSIFIED"}</span>
            </div>
            <div class="detail-group">
                <span class="detail-label" data-translate="card.location"></span>
                <span class="detail-value clickable-system" data-system="${L}" title="${u("tooltip.searchFor",{itemName:L},`Search for ${L}`)}">${L}<i class="fa-sharp fa-solid fa-arrow-up-right-from-square"></i></span>
            </div>
        </div>
        <div class="incident-timestamp">
            <div class="timestamp-group">
                <span class="detail-label timestamp-label" data-translate="${c}"></span>
                <span class="timestamp-value">${r}</span>
                ${l?`<span class="time-elapsed">${l}</span>`:""}
            </div>
        </div>
        ${S}
    `,t}function D(e,a){if(!e||e==="UNKNOWN"||e==="CLASSIFIED"){console.warn("Cannot search for empty, unknown, or classified values");return}const n=`${window.location.pathname.endsWith("index.html")||window.location.pathname==="/"||window.location.pathname.endsWith("/Alpha-Strike-Main/")?"pages/search.html":window.location.pathname.includes("/pages/")?"search.html":"../pages/search.html"}?query=${encodeURIComponent(e)}&type=${a}`;window.location.href=n}function M(){for(const e of document.querySelectorAll(".clickable-name"))e.dataset.listenerAttached||(e.addEventListener("click",a=>{a.preventDefault();const t=e.dataset.name;t&&t!=="UNKNOWN"&&D(t,"name")}),e.dataset.listenerAttached="true");for(const e of document.querySelectorAll(".clickable-system"))e.dataset.listenerAttached||(e.addEventListener("click",a=>{a.preventDefault();const t=e.dataset.system;t&&t!=="UNKNOWN"&&D(t,"system")}),e.dataset.listenerAttached="true")}function K(e){if(typeof z=="function")z(e);else{console.error("initializeNavigation function is not defined. Ensure components/navigation.js is loaded.");return}typeof x=="function"?x():console.error("initializeLanguageSwitcher function not found. Ensure translation-dictionary.js is loaded correctly and defines it.");const a=document.getElementById("timezone-toggle");if(a&&(a.hasAttribute("data-listener-attached")||(a.addEventListener("click",_),a.setAttribute("data-listener-attached","true"))),typeof w=="function"&&typeof d<"u"&&d.length>0){const t=localStorage.getItem("preferredLanguage")||d[0];w(t)}else console.error("setLanguage function or languages array not found. Translation system might not be fully initialized.")}function q(e,a,t,i={}){const n=document.getElementById(a);if(!n){console.error(`Container with ID ${a} not found`);return}if(n.innerHTML="",!e||e.length===0){n.textContent=i.noDataMessage||"No data available.";return}i.sortBy&&i.sortDirection&&e.sort((o,r)=>{const l=o&&typeof o=="object"&&Object.prototype.hasOwnProperty.call(o,i.sortBy)?o[i.sortBy]:void 0,c=r&&typeof r=="object"&&Object.prototype.hasOwnProperty.call(r,i.sortBy)?r[i.sortBy]:void 0;if(l==null)return i.sortDirection==="desc"?1:-1;if(c==null)return i.sortDirection==="desc"?-1:1;let p=0;return l>c?p=1:l<c&&(p=-1),i.sortDirection==="desc"?p*-1:p});let s=e;if(i.limit&&(s=e.slice(0,i.limit)),[...s].map(o=>{const r=t(o);r?n.appendChild(r):console.warn("Skipping invalid card for item:",o)}),typeof M=="function"&&M(),typeof w=="function"&&typeof d<"u"&&d.length>0){const o=localStorage.getItem("preferredLanguage")||d[0];w(o)}}async function h(e){try{const a=await fetch(e);if(!a.ok)throw new Error(`HTTP error! Status: ${a.status}`);return await a.json()}catch(a){throw console.error("Error fetching data:",a),a}}async function j(){return await h("https://api.alpha-strike.space/incident?filter=month")}async function Y(e){return await h(`https://api.alpha-strike.space/incident?mail_id=${e}`)}async function V(e="month"){return await h(`https://api.alpha-strike.space/totals?filter=${e}`)}async function Z(e="week"){return await h(`https://api.alpha-strike.space/totals?filter=${e}`)}async function G(e="day"){return await h(`https://api.alpha-strike.space/totals?filter=${e}`)}async function J(e,a){const t=a==="system"?`https://api.alpha-strike.space/incident?system=${encodeURIComponent(e)}`:`https://api.alpha-strike.space/incident?name=${encodeURIComponent(e)}`;return await h(t)}async function Q(e,a){const t=a==="system"?`https://api.alpha-strike.space/totals?system=${encodeURIComponent(e)}`:`https://api.alpha-strike.space/totals?name=${encodeURIComponent(e)}`;return await h(t)}export{d as a,Y as b,W as c,q as d,B as e,j as f,g,M as h,K as i,m as j,k,P as l,J as m,Q as n,G as o,Z as p,V as q,D as r,w as s,f as t};
