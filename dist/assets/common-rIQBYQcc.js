(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();function ee(e){const t=document.getElementById("navigation-container");if(t){const a=window.location.pathname.endsWith("index.html")||window.location.pathname==="/"||window.location.pathname.endsWith("/Alpha-Strike-Main/")?"":"../";t.innerHTML=`
      <div class="topnav" id="myTopnav">
        <a href="${a}index.html" class="nav-logo alpha-strike-logo">
            Alpha-Strike
        </a>
        <button class="hamburger-menu" id="hamburgerBtn" aria-label="Toggle menu" aria-expanded="false" aria-controls="topnavLinks">
            <i class="fas fa-bars" aria-hidden="true"></i>
        </button>
        <div class="topnav-links" id="topnavLinks">
            <a ${e==="home"?'class="active"':""} href="${a}index.html"><i class="fa-sharp fa-solid fa-trophy"></i> <span data-translate="navbar.home">Recently Stamped</span></a>
            <a ${e==="killers"?'class="active"':""} href="${a}pages/killers.html"><i class="fa-solid fa-skull-crossbones"></i> <span data-translate="navbar.killers">Leading Killers</span></a>
            <a ${e==="victims"?'class="active"':""} href="${a}pages/victims.html"><i class="fa-solid fa-user-shield"></i> <span data-translate="navbar.victims">Leading Victims</span></a>
            <a ${e==="systems"?'class="active"':""} href="${a}pages/systems.html"><i class="fa-solid fa-map-location-dot"></i> <span data-translate="navbar.systems">Leading Systems</span></a>
            <a ${e==="tribes"?'class="active"':""} href="${a}pages/tribes.html"><i class="fa-solid fa-users"></i> <span data-translate="navbar.tribes">Leading Tribes</span></a>
            <div class="nav-search-container">
                <button id="navSearchToggle" class="nav-search-toggle" aria-label="Toggle search">
                    <i class="fa-solid fa-magnifying-glass"></i>
                </button>
                <div id="navSearchDropdown" class="nav-search-dropdown">
                    <div class="nav-search">
                        <select id="navSearchType">
                            <option value="name" data-translate="search.byName">Character</option>
                            <option value="system" data-translate="search.bySystem">System</option>
                            <option value="tribe" data-translate="search.byTribe">Tribe</option>
                        </select>
                        <input type="text" id="navSearchQuery" placeholder="Search..." data-translate="search.placeholder" />
                        <button id="navSearchBtn" aria-label="Search">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </button>
                    </div>
                </div>
            </div>
            <button id="animatedLangBtn" class="lang-btn-nav">EN</button>
        </div>
      </div>
    `;const n=document.getElementById("hamburgerBtn"),i=document.getElementById("topnavLinks"),s=document.getElementById("myTopnav"),o=n.querySelector("i");n&&i&&s&&o?n.addEventListener("click",()=>{i.classList.toggle("open"),s.classList.toggle("open");const l=i.classList.contains("open");n.setAttribute("aria-expanded",l.toString()),l?(o.classList.remove("fa-bars"),o.classList.add("fa-times")):(o.classList.remove("fa-times"),o.classList.add("fa-bars"))}):console.error("Hamburger menu elements not found. Navigation interactivity may be affected."),document.addEventListener("click",l=>{const u=document.querySelector(".nav-search-container"),h=document.getElementById("navSearchToggle"),f=document.getElementById("navSearchDropdown");u&&h&&f&&(u.contains(l.target)||f.classList.remove("show"))});const c=document.getElementById("navSearchToggle"),d=document.getElementById("navSearchDropdown");c&&d&&c.addEventListener("click",l=>{var u;l.stopPropagation(),d.classList.toggle("show"),d.classList.contains("show")&&((u=document.getElementById("navSearchQuery"))==null||u.focus())})}else console.error("Navigation container #navigation-container not found.")}let x={};const v=["en","es","ru","zh"];let E=0;function _(e,t){[...e.querySelectorAll("[data-translate]")].map(a=>{const n=a.getAttribute("data-translate"),i=x[n],s=i&&(i[t]||i.en)||n;if(s)if(a.tagName==="INPUT"&&a.placeholder!==void 0&&(n.includes(".placeholder")||n.endsWith("Placeholder")))a.placeholder=s;else if(a.tagName==="BUTTON"||a.classList.contains("timezone-toggle-floating")){const o=a.querySelector("i"),c=a.querySelector("span[data-translate]");c&&c.getAttribute("data-translate")===n?c.textContent=s:o?a.innerHTML=`${o.outerHTML} ${s}`:a.textContent=s}else{const o=a.firstChild;o&&o.nodeType===Node.ELEMENT_NODE&&o.tagName==="I"?a.innerHTML=`${o.outerHTML} ${s}`:a.textContent=s}})}function k(e){document.documentElement.lang=e,localStorage.setItem("preferredLanguage",e),_(document,e);const t=document.getElementById("animatedLangBtn");if(t){const n=t.querySelector("i.fa-globe"),i=n?`${n.outerHTML} `:"";t.innerHTML=`${i}${e.toUpperCase()}`}const r=v.indexOf(e);r!==-1&&(E=r);const a=new CustomEvent("languagechange",{detail:{lang:e}});document.dispatchEvent(a),window.AlphaStrike&&typeof window.AlphaStrike.onLanguageChangeRenderContent=="function"&&window.AlphaStrike.onLanguageChangeRenderContent()}function ye(){E=(E+1)%v.length;const e=v[E];k(e)}function te(){const e=document.getElementById("animatedLangBtn");if(e){const t=localStorage.getItem("preferredLanguage")||v[0],r=e.querySelector("i.fa-globe"),a=r?`${r.outerHTML} `:'<i class="fas fa-globe"></i> ';e.innerHTML=`${a}${t.toUpperCase()}`,e.addEventListener("click",ye)}else console.warn("#animatedLangBtn not found during language switcher initialization.")}async function we(){try{let e="";window.location.pathname.includes("/pages/")?e="../":(window.location.pathname.endsWith("/")||window.location.pathname.endsWith(".html"))&&(e="./");const t=await fetch(`${e}localization/translations.json`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status} for translations.json at ${e}localization/translations.json`);x=await t.json(),console.log("Translations loaded successfully.")}catch(e){console.error("Failed to load translations:",e),x={"error.loading":{en:"Error loading translations",es:"Error al cargar las traducciones",ru:"Ошибка загрузки переводов",zh:"加载翻译时出错"}}}}document.addEventListener("DOMContentLoaded",async()=>{await we();const e=localStorage.getItem("preferredLanguage")||v[0],t=v.indexOf(e);t!==-1?E=t:E=0,k(v[E])});class ve{constructor(){this.observer=null,this.init()}init(){"IntersectionObserver"in window&&(this.observer=new IntersectionObserver(t=>{t.forEach(r=>{if(r.isIntersecting){const a=r.target;a.dataset.src&&(a.src=a.dataset.src,a.removeAttribute("data-src")),this.observer.unobserve(a)}})},{rootMargin:"50px 0px",threshold:.01}))}addLazyLoading(t,r){this.observer?(t.dataset.src=r,t.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",this.observer.observe(t)):t.src=r}addLazyLoadingToImages(t){t.forEach(r=>{r.dataset.src&&this.addLazyLoading(r,r.dataset.src)})}testLazyLoading(){const t={intersectionObserverSupported:"IntersectionObserver"in window,observerInitialized:this.observer!==null,imagesObserved:0};if(this.observer){const r=document.querySelectorAll("img[data-src]");t.imagesObserved=r.length}return t.intersectionObserverSupported&&t.observerInitialized}}const ie=new ve;window.testLazyLoading=()=>ie.testLazyLoading();let I=!0;function oe(e,t=!0,r="en"){let a;if(typeof e=="string")a=new Date(e);else if(typeof e=="number")if(e<1e10)a=new Date(e*1e3);else if(e<1e13)a=new Date(e);else{const h=e/1e4-116444736e5;a=new Date(h)}if(!a||Number.isNaN(a.getTime())||a.getFullYear()>2100||a.getFullYear()<1970)return console.warn("Invalid timestamp:",e),"INVALID TIMESTAMP";if(t){const l=a.getFullYear(),u=String(a.getMonth()+1).padStart(2,"0"),h=String(a.getDate()).padStart(2,"0"),f=String(a.getHours()).padStart(2,"0"),m=String(a.getMinutes()).padStart(2,"0"),p=String(a.getSeconds()).padStart(2,"0"),w=a.toLocaleTimeString(r,{timeZoneName:"short"}).split(" ").pop();return`${l}.${u}.${h} - ${f}:${m}:${p} ${w}`}const n=a.getUTCFullYear(),i=String(a.getUTCMonth()+1).padStart(2,"0"),s=String(a.getUTCDate()).padStart(2,"0"),o=String(a.getUTCHours()).padStart(2,"0"),c=String(a.getUTCMinutes()).padStart(2,"0"),d=String(a.getUTCSeconds()).padStart(2,"0");return`${n}.${i}.${s} - ${o}:${c}:${d} UTC`}function Ce(){I=!I;const e=document.documentElement.lang||(typeof v<"u"?v[0]:"en");[...document.querySelectorAll(".timestamp-value")].map(n=>{const i=n.closest(".incident-list-item");i!=null&&i.dataset.timestamp&&(n.textContent=oe(typeof i.dataset.timestamp=="string"&&!Number.isNaN(i.dataset.timestamp)?Number(i.dataset.timestamp):i.dataset.timestamp,I))});const r=document.getElementById("timezone-toggle");if(r){const n=r.querySelector("span[data-translate]");if(n){const i=I?"timezone.showUtc":"timezone.showLocal";n.setAttribute("data-translate",i);const s=x[i],o=s?s[e]:void 0;o?n.textContent=o:(n.textContent=s?s.en:i,console.warn(`Translation not found for key: ${i}, lang: ${e}. Using fallback.`))}}[...document.querySelectorAll(".timestamp-group .detail-label")].map(n=>{const i=I?"card.localTimeLabel":"card.utcTimeLabel";if(n.setAttribute("data-translate",i),typeof x<"u"&&x[i]&&x[i][e])n.textContent=x[i][e];else{let s=i.replace("card.","").replace("Label","");s=`${s.charAt(0).toUpperCase()+s.slice(1)} TIME:`,n.textContent=s,console.warn(`Translation not found for key: ${i}, lang: ${e}. Using fallback.`)}}),window.AlphaStrike&&typeof window.AlphaStrike.onLanguageChangeRenderContent=="function"&&(console.log("ToggleTimezone: Calling page-specific render function."),window.AlphaStrike.onLanguageChangeRenderContent())}async function T(e){try{const t=await fetch(e);if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);return await t.json()}catch(t){throw console.error("Error fetching data:",t),t}}const be="https://world-api-stillness.live.tech.evefrontier.com";async function W(e){if(!e)return Promise.resolve(null);const t=`${be}/v2/smartcharacters/${e}`;try{const r=await T(t);return r||null}catch(r){return console.error(`Error fetching smart character by address ${e}:`,r),null}}async function Y(e){const t=W(e.killer_address),r=W(e.victim_address),[a,n]=await Promise.all([t,r]);return{...e,killer_id:a?a.id:null,victim_id:n?n.id:null,killer_portrait_url:a?a.portraitUrl:null,victim_portrait_url:n?n.portraitUrl:null}}async function je(e=20,t=0){const r=await T(`https://api.alpha-strike.space/incident?filter=month&limit=${e}&offset=${t}`);return!r||!Array.isArray(r)?[]:r}async function Ke(e){const t=await T(`https://api.alpha-strike.space/incident?mail_id=${e}`);if(!t||t.length===0)return null;const r=t[0];return[await Y(r)]}async function q(e,t,r,a){let n="";if(t==="system")n=`https://api.alpha-strike.space/incident?system=${encodeURIComponent(e)}`;else if(t==="name")n=`https://api.alpha-strike.space/incident?name=${encodeURIComponent(e)}`;else if(t==="tribe")n=`https://api.alpha-strike.space/incident?tribe=${encodeURIComponent(e)}`;else return[];r!==void 0&&a!==void 0&&(n+=`&limit=${r}&offset=${a}`);try{const i=await T(n);return!i||!Array.isArray(i)?[]:i}catch{return[]}}async function Ve(e="month"){return await T(`https://api.alpha-strike.space/totals?filter=${e}`)}async function Ye(e="week"){return await T(`https://api.alpha-strike.space/totals?filter=${e}`)}async function Ze(e="day"){return await T(`https://api.alpha-strike.space/totals?filter=${e}`)}async function xe(e,t){let r="";if(t==="system")r=`https://api.alpha-strike.space/totals?system=${encodeURIComponent(e)}`;else if(t==="name")r=`https://api.alpha-strike.space/totals?name=${encodeURIComponent(e)}`;else if(t==="tribe")r=`https://api.alpha-strike.space/totals?tribe=${encodeURIComponent(e)}`;else return[];return await T(r)}async function Le(e,t=1,r=0){const a=`https://api.alpha-strike.space/tribes?name=${encodeURIComponent(e)}&limit=${t}&offset=${r}`,n=await T(a);return Array.isArray(n)?n[0]||null:n}function se(e){let t;if(typeof e=="string")t=new Date(e);else if(typeof e=="number")if(e<1e10)t=new Date(e*1e3);else if(e<1e13)t=new Date(e);else{const u=e/1e4-116444736e5;t=new Date(u)}if(!t||Number.isNaN(t.getTime())||t.getFullYear()>2100||t.getFullYear()<1970)return"";const a=new Date-t;if(a<0)return"";const n=Math.floor(a/(1e3*60*60*24)),i=Math.floor(a%(1e3*60*60*24)/(1e3*60*60)),s=Math.floor(a%(1e3*60*60)/(1e3*60)),o=localStorage.getItem("preferredLanguage")||"en",c=(d,l={})=>{var h,f;let u=((h=x[d])==null?void 0:h[o])||((f=x[d])==null?void 0:f.en)||d;for(const m in l)u=u.replace(new RegExp(`\\{${m}\\}`,"g"),l[m]);return u};return n>0?c("time.daysHoursAgo",{days:n,hours:i}):i>0?c("time.hoursMinutesAgo",{hours:i,minutes:s}):s>0?c("time.minutesAgo",{minutes:s}):c("time.justNow")}function Ee(){document.querySelectorAll(".time-elapsed").forEach(t=>{const r=t.closest(".incident-list-item");if(r!=null&&r.dataset.timestamp){const a=typeof r.dataset.timestamp=="string"&&!Number.isNaN(Number(r.dataset.timestamp))?Number(r.dataset.timestamp):r.dataset.timestamp;t.textContent=se(a)}})}document.addEventListener("languagechange",()=>{Ee()});function le(e){if(!e||typeof e!="object")return console.warn("Invalid item passed to createIncidentCard:",e),null;if(e.id===void 0||e.id===null)return console.warn("Skipping card creation for item missing 'id':",e),null;if(!e.killer_name&&!e.victim_name&&!e.loss_type&&!e.solar_system_name&&!e.time_stamp)return console.warn("Skipping card creation for effectively empty item:",e),null;const r=document.createElement("div");r.className="incident-list-item",r.dataset.timestamp=e.time_stamp;const a=window.location.pathname.endsWith("index.html")||window.location.pathname==="/"||window.location.pathname.endsWith("/Alpha-Strike-Main/"),n=a?"./":"../",i=a?"pages/":"",s=e.time_stamp?oe(e.time_stamp,I,localStorage.getItem("preferredLanguage")||"en"):"N/A",o=e.time_stamp?se(e.time_stamp):"",c=I?"card.localTimeLabel":"card.utcTimeLabel",d=V(e.killer_portrait_url,n),l=V(e.victim_portrait_url,n),u=localStorage.getItem("preferredLanguage")||"en";function h(O,Q={},ge=""){var G,J;let P=ge;typeof x<"u"&&((G=x[O])!=null&&G[u])?P=x[O][u]:typeof x<"u"&&((J=x[O])!=null&&J.en)&&(P=x[O].en);for(const X in Q)P=P.replace(`{${X}}`,Q[X]);return P}const f=e.killer_name||"UNKNOWN",m=e.victim_name||"UNKNOWN",p=e.solar_system_name||"UNKNOWN",w=e.killer_tribe_name||"UNKNOWN",C=e.victim_tribe_name||"UNKNOWN",$=typeof e.killer_tribe_name=="string"&&e.killer_tribe_name.toUpperCase()!=="NONE",L=typeof e.victim_tribe_name=="string"&&e.victim_tribe_name.toUpperCase()!=="NONE",y=$?"":'style="visibility: hidden;" aria-hidden="true"',b=L?"":'style="visibility: hidden;" aria-hidden="true"',g=`
        <div class="tribe-info">
            <div class="combatant-info killer-info" ${y}>
                <span class="tribe-label" data-translate="card.tribe"></span>
                <span class="tribe-name tribe killer clickable-tribe" data-tribe="${w}" title="${h("tooltip.searchFor",{itemName:w},`Search for ${w}`)}">${w}<i class="fa-sharp fa-solid fa-arrow-up-right-from-square"></i></span>
            </div>
            <div class="combatant-info victim-info" ${b}>
                <span class="tribe-label" data-translate="card.tribe"></span>
                <span class="tribe-name tribe victim clickable-tribe" data-tribe="${C}" title="${h("tooltip.searchFor",{itemName:C},`Search for ${C}`)}">${C}<i class="fa-sharp fa-solid fa-arrow-up-right-from-square"></i></span>
            </div>
        </div>
    `;let S="";const N=e.id,H=h("tooltip.viewKillmailDetails",{killmailId:N},`View details for killmail ${N}`);return S=`
      <div class="incident-detail-link-container">
          <a href="${i}killmail.html?mail_id=${encodeURIComponent(N)}"
             class="view-killmail-details-link icon-only-link"
             aria-label="${H}"
             title="${H}">
             <i class="fa-sharp fa-solid fa-arrow-up-right-from-square"></i>
          </a>
      </div>
  `,r.innerHTML=`
        <div class="incident-photos">
            <div class="photo-container killer-photo">
                <img src="${d}" alt="Aggressor" class="combatant-photo killer-image"/>
            </div>
            <div class="vs-indicator"><i class="fas fa-bolt"></i></div>
            <div class="photo-container victim-photo">
                <img src="${l}" alt="Victim" class="combatant-photo victim-image"/>
            </div>
        </div>
        <div class="incident-combatants">
            <div class="combatant-info killer-info">
                <span class="combatant-label" data-translate="card.aggressor"></span>
                <span class="combatant-name killer clickable-name" data-name="${f}" title="${h("tooltip.searchFor",{itemName:f},`Search for ${f}`)}">${f}<i class="fa-sharp fa-solid fa-arrow-up-right-from-square"></i></span>
            </div>
            <div class="combatant-info victim-info">
                <span class="combatant-label" data-translate="card.casualty"></span>
                <span class="combatant-name victim clickable-name" data-name="${m}" title="${h("tooltip.searchFor",{itemName:m},`Search for ${m}`)}">${m}<i class="fa-sharp fa-solid fa-arrow-up-right-from-square"></i></span>
            </div>
        </div>
        ${g}
        <div class="incident-details-compact">
            <div class="detail-group">
                <span class="detail-label" data-translate="card.lossType"></span>
                <span class="detail-value">${e.loss_type||"CLASSIFIED"}</span>
            </div>
            <div class="detail-group">
                <span class="detail-label" data-translate="card.location"></span>
                <span class="detail-value clickable-system" data-system="${p}" title="${h("tooltip.searchFor",{itemName:p},`Search for ${p}`)}">${p}<i class="fa-sharp fa-solid fa-arrow-up-right-from-square"></i></span>
            </div>
        </div>
        <div class="incident-timestamp">
            <div class="timestamp-group">
                <span class="detail-label timestamp-label" data-translate="${c}"></span>
                <span class="timestamp-value">${s}</span>
                ${o?`<span class="time-elapsed">${o}</span>`:""}
            </div>
        </div>
        ${S}
    `,r}function z(e,t){if(!e||e==="UNKNOWN"||e==="CLASSIFIED"){console.warn("Cannot search for empty, unknown, or classified values");return}const n=`${window.location.pathname.endsWith("index.html")||window.location.pathname==="/"||window.location.pathname.endsWith("/Alpha-Strike-Main/")?"pages/search.html":window.location.pathname.includes("/pages/")?"search.html":"../pages/search.html"}?query=${encodeURIComponent(e)}&type=${t}`;window.location.href=n}function B(e){const t=e||document;for(const r of t.querySelectorAll(".clickable-name"))r.dataset.listenerAttached||(r.addEventListener("click",a=>{a.preventDefault();const n=r.dataset.name;n&&n!=="UNKNOWN"&&z(n,"name")}),r.dataset.listenerAttached="true");for(const r of t.querySelectorAll(".clickable-system"))r.dataset.listenerAttached||(r.addEventListener("click",a=>{a.preventDefault();const n=r.dataset.system;n&&n!=="UNKNOWN"&&z(n,"system")}),r.dataset.listenerAttached="true");for(const r of t.querySelectorAll(".clickable-tribe"))r.dataset.listenerAttached||(r.addEventListener("click",a=>{a.preventDefault();const n=r.dataset.tribe;n&&n!=="UNKNOWN"&&z(n,"tribe")}),r.dataset.listenerAttached="true",r.style.cursor="pointer")}const Se="modulepreload",Te=function(e){return"/"+e},re={},ae=function(t,r,a){let n=Promise.resolve();if(r&&r.length>0){let s=function(d){return Promise.all(d.map(l=>Promise.resolve(l).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=s(r.map(d=>{if(d=Te(d),d in re)return;re[d]=!0;const l=d.endsWith(".css"),u=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${u}`))return;const h=document.createElement("link");if(h.rel=l?"stylesheet":Se,l||(h.as="script"),h.crossOrigin="",h.href=d,c&&h.setAttribute("nonce",c),document.head.appendChild(h),l)return new Promise((f,m)=>{h.addEventListener("load",f),h.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(s){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s}return n.then(s=>{for(const o of s||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})};function $e(){const e=v[E],t=x["loading.overlay"];return t&&(t[e]||t.en)||"Loading..."}function ke(e){let t=document.createElement("div");t.id="loading-overlay",t.className="sci-fi-loading-overlay";const r=`
<svg class="loader-svg" xmlns="http://www.w3.org/2000/svg" width="38" height="43" viewBox="0 0 38 43" fill="none">
<rect x="20.5" y="0.5" width="2" height="2" fill="currentColor"></rect><rect x="25.5" y="0.5" width="2" height="2" fill="currentColor"></rect><rect x="30.5" y="0.5" width="2" height="2" fill="currentColor"></rect><rect x="35.5" y="0.5" width="2" height="2" fill="currentColor"></rect><rect x="20.5" y="5.5" width="2" height="2" fill="currentColor"></rect><rect x="25.5" y="5.5" width="2" height="2" fill="currentColor"></rect><rect x="30.5" y="5.5" width="2" height="2" fill="currentColor"></rect><rect x="35.5" y="5.5" width="2" height="2" fill="currentColor"></rect><rect x="20.5" y="10.5" width="2" height="2" fill="currentColor"></rect><rect x="25.5" y="10.5" width="2" height="2" fill="currentColor"></rect><rect x="30.5" y="10.5" width="2" height="2" fill="currentColor"></rect><rect x="35.5" y="10.5" width="2" height="2" fill="currentColor"></rect><rect x="20.5" y="30.5" width="2" height="2" fill="currentColor"></rect><rect x="25.5" y="30.5" width="2" height="2" fill="currentColor"></rect><rect x="30.5" y="30.5" width="2" height="2" fill="currentColor"></rect><rect x="35.5" y="30.5" width="2" height="2" fill="currentColor"></rect><rect x="20.5" y="35.5" width="2" height="2" fill="currentColor"></rect><rect x="25.5" y="35.5" width="2" height="2" fill="currentColor"></rect><rect x="30.5" y="35.5" width="2" height="2" fill="currentColor"></rect><rect x="35.5" y="35.5" width="2" height="2" fill="currentColor"></rect><rect x="20.5" y="40.5" width="2" height="2" fill="currentColor"></rect><rect x="25.5" y="40.5" width="2" height="2" fill="currentColor"></rect><rect x="30.5" y="40.5" width="2" height="2" fill="currentColor"></rect><rect x="35.5" y="40.5" width="2" height="2" fill="currentColor"></rect><rect x="20.5" y="15.5" width="2" height="2" fill="currentColor"></rect><rect x="25.5" y="15.5" width="2" height="2" fill="currentColor"></rect><rect x="30.5" y="15.5" width="2" height="2" fill="currentColor"></rect><rect x="35.5" y="15.5" width="2" height="2" fill="currentColor"></rect><rect x="20.5" y="20.5" width="2" height="2" fill="currentColor"></rect><rect x="25.5" y="20.5" width="2" height="2" fill="currentColor"></rect><rect x="30.5" y="20.5" width="2" height="2" fill="currentColor"></rect><rect x="35.5" y="20.5" width="2" height="2" fill="currentColor"></rect><rect x="20.5" y="25.5" width="2" height="2" fill="currentColor"></rect><rect x="25.5" y="25.5" width="2" height="2" fill="currentColor"></rect><rect x="30.5" y="25.5" width="2" height="2" fill="currentColor"></rect><rect x="35.5" y="25.5" width="2" height="2" fill="currentColor"></rect><rect x="0.5" y="0.5" width="2" height="2" fill="currentColor"></rect><rect x="5.5" y="0.5" width="2" height="2" fill="currentColor"></rect><rect x="10.5" y="0.5" width="2" height="2" fill="currentColor"></rect><rect x="15.5" y="0.5" width="2" height="2" fill="currentColor"></rect><rect x="0.5" y="5.5" width="2" height="2" fill="currentColor"></rect><rect x="5.5" y="5.5" width="2" height="2" fill="currentColor"></rect><rect x="10.5" y="5.5" width="2" height="2" fill="currentColor"></rect><rect x="15.5" y="5.5" width="2" height="2" fill="currentColor"></rect><rect x="0.5" y="10.5" width="2" height="2" fill="currentColor"></rect><rect x="5.5" y="10.5" width="2" height="2" fill="currentColor"></rect><rect x="10.5" y="10.5" width="2" height="2" fill="currentColor"></rect><rect x="15.5" y="10.5" width="2" height="2" fill="currentColor"></rect><rect x="0.5" y="30.5" width="2" height="2" fill="currentColor"></rect><rect x="5.5" y="30.5" width="2" height="2" fill="currentColor"></rect><rect x="10.5" y="30.5" width="2" height="2" fill="currentColor"></rect><rect x="15.5" y="30.5" width="2" height="2" fill="currentColor"></rect><rect x="0.5" y="35.5" width="2" height="2" fill="currentColor"></rect><rect x="5.5" y="35.5" width="2" height="2" fill="currentColor"></rect><rect x="10.5" y="35.5" width="2" height="2" fill="currentColor"></rect><rect x="15.5" y="35.5" width="2" height="2" fill="currentColor"></rect><rect x="0.5" y="40.5" width="2" height="2" fill="currentColor"></rect><rect x="5.5" y="40.5" width="2" height="2" fill="currentColor"></rect><rect x="10.5" y="40.5" width="2" height="2" fill="currentColor"></rect><rect x="15.5" y="40.5" width="2" height="2" fill="currentColor"></rect><rect x="0.5" y="15.5" width="2" height="2" fill="currentColor"></rect><rect x="5.5" y="15.5" width="2" height="2" fill="currentColor"></rect><rect x="10.5" y="15.5" width="2" height="2" fill="currentColor"></rect><rect x="15.5" y="15.5" width="2" height="2" fill="currentColor"></rect><rect x="0.5" y="20.5" width="2" height="2" fill="currentColor"></rect><rect x="5.5" y="20.5" width="2" height="2" fill="currentColor"></rect><rect x="10.5" y="20.5" width="2" height="2" fill="currentColor"></rect><rect x="15.5" y="20.5" width="2" height="2" fill="currentColor"></rect><rect x="0.5" y="25.5" width="2" height="2" fill="currentColor"></rect><rect x="5.5" y="25.5" width="2" height="2" fill="currentColor"></rect><rect x="10.5" y="25.5" width="2" height="2" fill="currentColor"></rect><rect x="15.5" y="25.5" width="2" height="2" fill="currentColor"></rect>
</svg>`.trim(),a=Array(10).fill(r).join("");t.innerHTML=`
        <div class="sci-fi-loader">
            <div class="loader-svg-container">
                ${a}
            </div>
            <span class="loader-text" data-translate="loading.overlay">${$e()}</span>
        </div>
    `,document.body.appendChild(t)}function Ne(){const e=document.getElementById("loading-overlay");e&&e.remove()}const R=(e,t="")=>{var a,n;const r=v[E];return((a=x[e])==null?void 0:a[r])||((n=x[e])==null?void 0:n.en)||t};function ce(e){const t=Math.min(1,Math.max(0,Number(e)||0)),r=[{p:0,r:210,g:36,b:36},{p:.67,r:207,g:199,b:54},{p:.9,r:45,g:200,b:110},{p:1,r:45,g:165,b:195}];if(t<=r[0].p){const{r:s,g:o,b:c}=r[0];return`rgb(${s}, ${o}, ${c})`}for(let s=1;s<r.length;s++){const o=r[s-1],c=r[s];if(t<=c.p){const d=(t-o.p)/(c.p-o.p),l=Math.round(o.r+d*(c.r-o.r)),u=Math.round(o.g+d*(c.g-o.g)),h=Math.round(o.b+d*(c.b-o.b));return`rgb(${l}, ${u}, ${h})`}}const{r:a,g:n,b:i}=r[r.length-1];return`rgb(${a}, ${n}, ${i})`}function de(e){const t=Math.min(1,Math.max(0,Number(e)||0));return t<=.1?"stoic":t<=.25?"probing":t<=.33?"prowling":t<=.42?"stalking":t<=.5?"menacing":t<=.67?"predatory":t<=.9?"ruthless":"lethal"}function he(e){const t=e.total_losses>0?(e.total_kills/e.total_losses).toFixed(2):e.total_kills||0,r=(e.total_kills||0)+(e.total_losses||0),a=r>0?((e.total_kills||0)/r*100).toFixed(1):0;return{killDeathRatio:t,totalEngagements:r,winRate:a}}function Ie(e,t,r){const a=document.createElement("div");a.className="card-header";const n=document.createElement("div");n.className="profile-section";const i=document.createElement("div");i.className="profile-image-container";const s=document.createElement("img");s.className="profile-image",s.alt=`${e.name}'s profile`;const c=window.location.pathname.endsWith("index.html")||window.location.pathname==="/"||window.location.pathname.endsWith("/Alpha-Strike-Main/")?"./":"../";s.src=V(r,c),i.appendChild(s);const d=document.createElement("div");d.className="profile-info";const l=document.createElement("h1");l.className="player-name",l.textContent=e.name;const u=document.createElement("p");u.className="player-status clickable-tribe",u.dataset.tribe=e.tribe_name,u.title=R("tooltip.searchFor","Search for: ",{itemName:e.tribe_name})+e.tribe_name,u.textContent=e.tribe_name||R("general.unknown");const h=document.createElement("i");h.className="fa-sharp fa-solid fa-arrow-up-right-from-square",h.setAttribute("aria-hidden","true"),h.style="margin-left: 0.1rem; vertical-align: super; font-size: 0.5rem;",u.appendChild(h),d.appendChild(l),d.appendChild(u),n.appendChild(i),n.appendChild(d);const f=document.createElement("div");f.className="header-stats";const m=document.createElement("div");m.className="header-stat",m.innerHTML=`
        <div class="header-stat-value ${t.killDeathRatio>1?"killer":"victim"}">${t.killDeathRatio}</div>
        <div class="header-stat-label" data-translate="card.kdRatio">K/D Ratio</div>
    `;const p=document.createElement("div");p.className="header-stat",p.innerHTML=`
        <div class="header-stat-value">${t.winRate}%</div>
        <div class="header-stat-label" data-translate="card.winRate">Win Rate</div>
    `;const w=Math.min(1,Math.max(0,(parseFloat(t.winRate)||0)/100)),C=ce(w),$=p.querySelector(".header-stat-value");$&&($.style.color=C);const L=document.createElement("div");L.className="header-stat-descriptor",L.textContent=de(w).toUpperCase();const y=p.querySelector(".header-stat-label");y?p.insertBefore(L,y):p.appendChild(L);const b=document.createElement("div");return b.className="header-stat",b.innerHTML=`
        <div class="header-stat-value">${t.totalEngagements}</div>
        <div class="header-stat-label" data-translate="card.totalEngagements">Total Engagements</div>
    `,f.appendChild(m),f.appendChild(p),f.appendChild(b),a.appendChild(n),a.appendChild(f),a}function _e(e){const t=e.incident_count&&e.days_active?(e.incident_count/e.days_active).toFixed(1):"< 1",r=e.incident_count>100?"HIGH":e.incident_count>50?"MEDIUM":"LOW";return{avgIncidentsPerDay:t,threatLevel:r,threatClass:r==="HIGH"?"threat-high":r==="MEDIUM"?"threat-medium":"threat-low",totalIncidents:e.incident_count||0,activeDays:e.days_active||0}}function Ae(e,t){const r=document.createElement("div");r.className="card-header";const a=document.createElement("div");a.className="system-section";const n=document.createElement("div");n.className="system-image-container";const i=document.createElement("i");i.className="fa-solid fa-sun system-image",i.setAttribute("aria-label","system star"),n.appendChild(i);const s=document.createElement("div");s.className="system-info";const o=document.createElement("h2");o.className="system-name",o.textContent=e.solar_system_name||e.name;const c=document.createElement("p");c.className="system-region",c.textContent=e.region_name||e.region||R("general.unknown"),s.appendChild(o),s.appendChild(c),a.appendChild(n),a.appendChild(s);const d=document.createElement("div");d.className="header-stats";const l=document.createElement("div");l.className="header-stat",l.innerHTML=`
        <div class="header-stat-value ${t.threatClass}">${t.totalIncidents}</div>
        <div class="header-stat-label" data-translate="card.incidentCount">Incidents</div>
    `;const u=document.createElement("div");u.className="header-stat",u.innerHTML=`
        <div class="header-stat-value">${t.avgIncidentsPerDay}</div>
        <div class="header-stat-label" data-translate="card.avgPerDay">Per Day</div>
    `;const h=document.createElement("div");return h.className="header-stat",h.innerHTML=`
        <div class="header-stat-value">${t.activeDays}</div>
        <div class="header-stat-label" data-translate="card.activeDays">Active Days</div>
    `,d.appendChild(l),d.appendChild(u),d.appendChild(h),r.appendChild(a),r.appendChild(d),r}async function Me(e,t){const r=document.createElement("div");r.className="card-header";const a=document.createElement("div");a.className="profile-section";const n=document.createElement("div");n.className="profile-image-container";const i=document.createElement("i");i.className="fa-solid fa-users-line system-image",i.setAttribute("aria-label","tribe logo"),n.appendChild(i);const s=document.createElement("div");s.className="profile-info";const o=document.createElement("h1");if(o.className="player-name clickable-tribe",o.textContent=e.tribe_name,o.dataset.tribe=e.tribe_name,o.title=R("tooltip.searchFor","Search for: ")+e.tribe_name,s.appendChild(o),e.tribe_url&&e.tribe_url!=="NONE"){const L=document.createElement("div");L.className="tribe-url";const y=document.createElement("a");y.href=e.tribe_url,y.target="_blank",y.rel="noopener noreferrer",y.textContent="Tribe URL",y.addEventListener("click",async b=>{try{b.preventDefault();const g=await ae(()=>import("./modal-DOW2Qn16.js"),[]);g&&typeof g.showExternalLinkModal=="function"?g.showExternalLinkModal(e.tribe_url):window.open(e.tribe_url,"_blank","noopener,noreferrer")}catch{window.open(e.tribe_url,"_blank","noopener,noreferrer")}}),L.appendChild(y),s.appendChild(L)}a.appendChild(n),a.appendChild(s);const c=document.createElement("div");c.className="header-stats";const d=document.createElement("div");d.className="header-stat",d.innerHTML=`
        <div class="header-stat-value ${t.killDeathRatio>1?"killer":"victim"}">${t.killDeathRatio}</div>
        <div class="header-stat-label" data-translate="card.kdRatio">K/D Ratio</div>
    `;const l=document.createElement("div");l.className="header-stat",l.innerHTML=`
        <div class="header-stat-value">${t.winRate}%</div>
        <div class="header-stat-label" data-translate="card.winRate">Win Rate</div>
    `;const u=Math.min(1,Math.max(0,(parseFloat(t.winRate)||0)/100)),h=ce(u),f=l.querySelector(".header-stat-value");f&&(f.style.color=h);const m=document.createElement("div");m.className="header-stat-descriptor",m.textContent=de(u).toUpperCase();const p=l.querySelector(".header-stat-label");p?l.insertBefore(m,p):l.appendChild(m);const w=document.createElement("div");w.className="header-stat",w.innerHTML=`
        <div class="header-stat-value">${t.totalEngagements}</div>
        <div class="header-stat-label" data-translate="card.totalEngagements">Total Engagements</div>
    `;const C=document.createElement("div");C.className="header-stat",C.innerHTML=`
        <div class="header-stat-value">${e.member_count}</div>
        <div class="header-stat-label">
          <span data-translate="card.numCharacters">Member Count</span>
          <i class="fa-sharp fa-solid fa-arrow-up-right-from-square" aria-hidden="true" style="margin-left: 0.2rem; font-size: 0.5rem; vertical-align: super;"></i>
        </div>
    `;const $=await ae(()=>import("./tribeCharacterModal-Cvv1VXoy.js"),[]);return C.addEventListener("click",()=>{$.showTribeCharacterModal(e.tribe_name)}),C.classList.add("clickable"),C.title=R("card.numCharacters","Member Count"),C.setAttribute("role","button"),C.tabIndex=0,C.addEventListener("keydown",L=>{(L.key==="Enter"||L.key===" ")&&(L.preventDefault(),C.click())}),c.appendChild(d),c.appendChild(l),c.appendChild(w),c.appendChild(C),r.appendChild(a),r.appendChild(c),r}async function De(e){const t=document.createElement("div");t.className="data-card enhanced-player-card",t.dataset.id=e.id;let r=e.portraitUrl||null;if(!r&&e.character_address)try{const i=await W(e.character_address);i&&(r=i.portraitUrl)}catch(i){console.warn(`Could not fetch character by address for card: ${e.character_address}`,i)}const a=he(e),n=Ie(e,a,r);return t.appendChild(n),t}async function Ue(e){const t=document.createElement("div");t.className="data-card enhanced-player-card",t.dataset.id=e.id;try{const n=await Le(e.tribe_name,1,0);n&&n.tribe_url&&(e.tribe_url=n.tribe_url,e.member_count=n.member_count)}catch(n){console.warn("Failed to fetch tribe data for card:",e.tribe_name,n)}const r=he(e),a=await Me(e,r);return t.appendChild(a),t}function Pe(e){const t=document.createElement("div");t.className="data-card enhanced-system-card",t.dataset.id=e.id;const r=_e(e),a=Ae(e,r);t.appendChild(a);const n=t.querySelector(".system-image");return n&&ie.addLazyLoading(n,"https://images.evetech.net/types/3796/render"),t}async function Be(e,t){const r=document.getElementById("totals-card");r.innerHTML="",ke();try{if(!e||e.length===0){r.innerHTML='<p data-translate="search.noAggregatedData">No aggregated data found.</p>';return}const a=e[0];let n=null;t==="system"?n=Pe(a):t==="name"?n=await De(a):t==="tribe"&&(n=await Ue(a)),r.appendChild(n),B(n)}catch(a){console.error("Failed to render aggregate card:",a),r.innerHTML='<p data-translate="search.error">Error loading aggregated data.</p>'}finally{Ne()}}function ue(e,t="loading.data"){if(!e)return;const r=document.createElement("div");r.className="inline-loader-wrapper";const a=`
<svg class="inline-loader-svg" xmlns="http://www.w3.org/2000/svg" width="38" height="43" viewBox="0 0 38 43" fill="none">
<rect x="20.5" y="0.5" width="2" height="2" fill="currentColor"></rect><rect x="25.5" y="0.5" width="2" height="2" fill="currentColor"></rect><rect x="30.5" y="0.5" width="2" height="2" fill="currentColor"></rect><rect x="35.5" y="0.5" width="2" height="2" fill="currentColor"></rect><rect x="20.5" y="5.5" width="2" height="2" fill="currentColor"></rect><rect x="25.5" y="5.5" width="2" height="2" fill="currentColor"></rect><rect x="30.5" y="5.5" width="2" height="2" fill="currentColor"></rect><rect x="35.5" y="5.5" width="2" height="2" fill="currentColor"></rect><rect x="20.5" y="10.5" width="2" height="2" fill="currentColor"></rect><rect x="25.5" y="10.5" width="2" height="2" fill="currentColor"></rect><rect x="30.5" y="10.5" width="2" height="2" fill="currentColor"></rect><rect x="35.5" y="10.5" width="2" height="2" fill="currentColor"></rect><rect x="20.5" y="30.5" width="2" height="2" fill="currentColor"></rect><rect x="25.5" y="30.5" width="2" height="2" fill="currentColor"></rect><rect x="30.5" y="30.5" width="2" height="2" fill="currentColor"></rect><rect x="35.5" y="30.5" width="2" height="2" fill="currentColor"></rect><rect x="20.5" y="35.5" width="2" height="2" fill="currentColor"></rect><rect x="25.5" y="35.5" width="2" height="2" fill="currentColor"></rect><rect x="30.5" y="35.5" width="2" height="2" fill="currentColor"></rect><rect x="35.5" y="35.5" width="2" height="2" fill="currentColor"></rect><rect x="20.5" y="40.5" width="2" height="2" fill="currentColor"></rect><rect x="25.5" y="40.5" width="2" height="2" fill="currentColor"></rect><rect x="30.5" y="40.5" width="2" height="2" fill="currentColor"></rect><rect x="35.5" y="40.5" width="2" height="2" fill="currentColor"></rect><rect x="20.5" y="15.5" width="2" height="2" fill="currentColor"></rect><rect x="25.5" y="15.5" width="2" height="2" fill="currentColor"></rect><rect x="30.5" y="15.5" width="2" height="2" fill="currentColor"></rect><rect x="35.5" y="15.5" width="2" height="2" fill="currentColor"></rect><rect x="20.5" y="20.5" width="2" height="2" fill="currentColor"></rect><rect x="25.5" y="20.5" width="2" height="2" fill="currentColor"></rect><rect x="30.5" y="20.5" width="2" height="2" fill="currentColor"></rect><rect x="35.5" y="20.5" width="2" height="2" fill="currentColor"></rect><rect x="20.5" y="25.5" width="2" height="2" fill="currentColor"></rect><rect x="25.5" y="25.5" width="2" height="2" fill="currentColor"></rect><rect x="30.5" y="25.5" width="2" height="2" fill="currentColor"></rect><rect x="35.5" y="25.5" width="2" height="2" fill="currentColor"></rect><rect x="0.5" y="0.5" width="2" height="2" fill="currentColor"></rect><rect x="5.5" y="0.5" width="2" height="2" fill="currentColor"></rect><rect x="10.5" y="0.5" width="2" height="2" fill="currentColor"></rect><rect x="15.5" y="0.5" width="2" height="2" fill="currentColor"></rect><rect x="0.5" y="5.5" width="2" height="2" fill="currentColor"></rect><rect x="5.5" y="5.5" width="2" height="2" fill="currentColor"></rect><rect x="10.5" y="5.5" width="2" height="2" fill="currentColor"></rect><rect x="15.5" y="5.5" width="2" height="2" fill="currentColor"></rect><rect x="0.5" y="10.5" width="2" height="2" fill="currentColor"></rect><rect x="5.5" y="10.5" width="2" height="2" fill="currentColor"></rect><rect x="10.5" y="10.5" width="2" height="2" fill="currentColor"></rect><rect x="15.5" y="10.5" width="2" height="2" fill="currentColor"></rect><rect x="0.5" y="30.5" width="2" height="2" fill="currentColor"></rect><rect x="5.5" y="30.5" width="2" height="2" fill="currentColor"></rect><rect x="10.5" y="30.5" width="2" height="2" fill="currentColor"></rect><rect x="15.5" y="30.5" width="2" height="2" fill="currentColor"></rect><rect x="0.5" y="35.5" width="2" height="2" fill="currentColor"></rect><rect x="5.5" y="35.5" width="2" height="2" fill="currentColor"></rect><rect x="10.5" y="35.5" width="2" height="2" fill="currentColor"></rect><rect x="15.5" y="35.5" width="2" height="2" fill="currentColor"></rect><rect x="0.5" y="40.5" width="2" height="2" fill="currentColor"></rect><rect x="5.5" y="40.5" width="2" height="2" fill="currentColor"></rect><rect x="10.5" y="40.5" width="2" height="2" fill="currentColor"></rect><rect x="15.5" y="40.5" width="2" height="2" fill="currentColor"></rect><rect x="0.5" y="15.5" width="2" height="2" fill="currentColor"></rect><rect x="5.5" y="15.5" width="2" height="2" fill="currentColor"></rect><rect x="10.5" y="15.5" width="2" height="2" fill="currentColor"></rect><rect x="15.5" y="15.5" width="2" height="2" fill="currentColor"></rect><rect x="0.5" y="20.5" width="2" height="2" fill="currentColor"></rect><rect x="5.5" y="20.5" width="2" height="2" fill="currentColor"></rect><rect x="10.5" y="20.5" width="2" height="2" fill="currentColor"></rect><rect x="15.5" y="20.5" width="2" height="2" fill="currentColor"></rect><rect x="0.5" y="25.5" width="2" height="2" fill="currentColor"></rect><rect x="5.5" y="25.5" width="2" height="2" fill="currentColor"></rect><rect x="10.5" y="25.5" width="2" height="2" fill="currentColor"></rect><rect x="15.5" y="25.5" width="2" height="2" fill="currentColor"></rect>
</svg>`.trim(),n=Array(10).fill(a).join("");r.innerHTML=`
    <div class="inline-loader">
        <div class="inline-loader-svg-container">
            ${n}
        </div>
      <span class="inline-loader-text" data-translate="${t}"></span>
    </div>
  `,_(r,v[E]),e.innerHTML="",e.appendChild(r)}function fe(e){if(e){const t=e.querySelector(".inline-loader-wrapper");t&&t.remove()}}function Re({container:e,currentPage:t,hasNextPage:r,onPageClick:a,totalPages:n=null}){if(!e)return;e.innerHTML="";const i=(l,u,h=!1,f=!1)=>{const m=document.createElement("button");return m.textContent=l,m.disabled=h,f&&m.classList.add("active"),m.addEventListener("click",()=>a(u)),m},s=n!==null?t<n:r;e.appendChild(i("«",t-1,t===1));const o=2;let c=Math.max(1,t-o),d;if(n?d=Math.min(n,t+o):d=t+o,c>1&&(e.appendChild(i("1",1)),c>2)){const l=document.createElement("span");l.textContent="...",e.appendChild(l)}for(let l=c;l<=d;l++)!n&&l>t&&!r||e.appendChild(i(l.toString(),l,!1,l===t));if(n&&d<n){if(d<n-1){const l=document.createElement("span");l.textContent="...",e.appendChild(l)}e.appendChild(i(n.toString(),n))}else if(!n&&r){const l=document.createElement("span");l.textContent="...",e.appendChild(l)}e.appendChild(i("»",t+1,!s))}const A=20;let D=1,U=!1,me="",j="",M=0;function ne(e){if(typeof e=="number")return e<1e10?e*1e3:e;if(typeof e=="string"){if(/^\d+$/.test(e)){const r=Number(e);return r<1e10?r*1e3:r}const t=Date.parse(e);return isNaN(t)?null:t}return null}function pe(e){return e.sort((t,r)=>{const a=ne(t.time_stamp),n=ne(r.time_stamp);return n!==null&&a!==null?n-a:n!==null?1:a!==null?-1:0})}function He(){const e=new URLSearchParams(window.location.search);return{query:e.get("query"),type:e.get("type")}}function Oe(){const e=document.getElementById("navSearchBtn"),t=document.getElementById("navSearchQuery"),r=document.getElementById("navSearchType");!e||!t||!r||(e.addEventListener("click",()=>{const a=t.value.trim();if(a===""){alert("Please enter a search query.");return}z(a,r.value)}),t.addEventListener("keypress",a=>{a.key==="Enter"&&e.click()}))}function ze(e,t){if(!e||!e.trim())return[];if(e=e.trim(),t==="system")return[e.toUpperCase()];const r=e.toLowerCase(),a=e.toUpperCase(),n=e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();return[...new Set([e,r,a,n])]}function F(){const e=document.getElementById("pagination-container");e&&(D>1||U?(e.style.display="flex",Re({container:e,currentPage:D,hasNextPage:U,onPageClick:Fe,totalPages:M>0?Math.ceil(M/A):null})):e.style.display="none")}async function Fe(e){const t=document.getElementById("results-container");ue(t,"Loading Incidents...");try{await K(e),t&&t.scrollIntoView({behavior:"smooth",block:"start"})}catch(r){console.error("Error fetching search page:",r),t.innerHTML='<p data-translate="search.error">Error loading search results.</p>'}finally{fe(t);const r=localStorage.getItem("preferredLanguage")||"en";k(r)}}async function K(e){if(e<1){D=1,U=!1;const r=document.getElementById("results-container");r.innerHTML='<p data-translate="search.noResults">No search results found.</p>',_(r,v[E]),F();return}const t=document.getElementById("results-container");try{let r=await q(me,j,1e3,0);r=pe(r);const a=(e-1)*A,n=r.slice(a,a+A);if(n.length===0&&e>1){await K(e-1);return}t.innerHTML="",D=e,U=r.length>a+A;const i=n;if(i.length===0)t.innerHTML='<p data-translate="search.noResults">No search results found.</p>',_(t,v[E]);else for(const s of i){const o=await Y(s),c=le(o);c&&(t.appendChild(c),B(c),_(c,v[E]))}F()}catch(r){console.warn(`Failed to fetch search page ${e}, trying page ${e-1}. Error:`,r),e>1?await K(e-1):(console.error("Error fetching initial search results:",r),t.innerHTML='<p data-translate="search.error">Error loading search results.</p>',D=1,U=!1,F())}}async function We(e,t){var l,u;const r=document.getElementById("results-container"),a=document.getElementById("totals-card"),n=document.getElementById("pagination-container");if(!r||!a||!n)return;D=1,M=0,ue(r,"Searching..."),a.innerHTML="",n.style.display="none";const i=ze(e,t);let s=null,o=[],c=[];for(const h of i)try{const[f,m]=await Promise.all([xe(h,t),q(h,t,A+1,0)]),p=Array.isArray(m)&&m.length>0,w=Array.isArray(f)&&f.length>0;if(p||t==="tribe"&&w){s=h,o=m,c=f||[];break}}catch{}if(s){if(me=s,j=t,c&&c.length>0){const f=c[0];if(t==="system"){M=f.incident_count||0;try{const m=new Set,p=y=>{let b;if(typeof y=="string"){let g=y.trim();/\bUTC\b/i.test(g)?(g=g.replace(/\s+UTC/i,""),g=g.replace(" ","T"),g=g.endsWith("Z")?g:g+"Z",b=new Date(g)):/[zZ]|[+\-]\d{2}:?\d{2}$/.test(g)?b=new Date(g):/^\d{4}-\d{2}-\d{2}(?:[ T]\d{2}:\d{2}:\d{2})?$/.test(g)?(g=g.replace(" ","T"),b=new Date(g+"Z")):b=new Date(g)}else if(typeof y=="number")if(y<1e10)b=new Date(y*1e3);else if(y<1e13)b=new Date(y);else{const N=y/1e4-116444736e5;b=new Date(N)}return b},w=500;let C=0;const $=200;let L=0;for(;L<$;){const y=await q(s,t,w,C);if(!Array.isArray(y)||y.length===0)break;for(const b of y){const g=b==null?void 0:b.time_stamp;if(g==null)continue;const S=p(g);if(!S||Number.isNaN(S.getTime()))continue;const N=S.getUTCFullYear(),Z=String(S.getUTCMonth()+1).padStart(2,"0"),H=String(S.getUTCDate()).padStart(2,"0");m.add(`${N}-${Z}-${H}`)}if(C+=y.length,y.length<w)break;L+=1}m.size>0&&(f.days_active=m.size)}catch{}}else if(t==="tribe")M=f.total_kills+f.total_losses||0;else if(M=(f.total_kills||0)+(f.total_losses||0),t==="name"&&(o==null?void 0:o.length)>0){const m=o[0];let p=null;if(((l=m.killer_name)==null?void 0:l.toLowerCase())===s.toLowerCase()?p=m.killer_address:((u=m.victim_name)==null?void 0:u.toLowerCase())===s.toLowerCase()&&(p=m.victim_address),p)try{const w=await W(p);w!=null&&w.portraitUrl&&(f.portraitUrl=w.portraitUrl)}catch(w){console.warn(`Could not fetch portrait for ${p}`,w)}}}await Be(c,t),r.innerHTML="",fe(r),o=pe(o),U=o.length>A;const h=o.slice(0,A);if(h.length>0)for(const f of h){const m=await Y(f),p=le(m);p&&(r.appendChild(p),B(p),_(p,v[E]))}else{const f=j==="tribe"?"search.noTribeIncidents":"search.noResults";r.innerHTML=`<p data-translate="${f}">No search results found.</p>`,r.style.textAlign="center",_(r,v[E])}F()}else r.innerHTML='<p data-translate="search.noResults">No results found for your query.</p>';const d=localStorage.getItem("preferredLanguage")||"en";k(d)}function Qe(){const{query:e,type:t}=He();e&&We(decodeURIComponent(e),t||"name")}const qe={"https://artifacts.evefrontier.com/portraits/PortraitAwakened256.png":"assets/images/portraits/PortraitAwakened256.avif","https://artifacts.evefrontier.com/portraits/PortraitAscended256.png":"assets/images/portraits/PortraitAscended256.avif","https://artifacts.evefrontier.com/portraits/PortraitRainmakers256.png":"assets/images/portraits/PortraitRainmakers256.avif","https://artifacts.evefrontier.com/portraits/PortraitInitiated256.png":"assets/images/portraits/PortraitInitiated256.avif","https://artifacts.evefrontier.com/Character/123456789_256.jpg":"assets/images/portraits/123456789_256.avif","https://artifacts.evefrontier.com/portraits/PortraitSeers256.png":"assets/images/portraits/PortraitSeers256.avif","https://artifacts.evefrontier.com/portraits/PortraitHarbingers256.png":"assets/images/portraits/PortraitHarbingers256.avif"};function V(e,t){const r=`${t}assets/images/default-avatar.avif`;if(!e)return console.warn("Missing portrait URL. Using default avatar. Please download the image and update the portraitUrlMapping in js/common.js.",e),r;const a=qe[e];return a?t+a:(console.warn(`Missing local mapping for portrait URL: "${e}". Using default avatar. Please download the image and update the portraitUrlMapping in js/common.js.`),r)}function Ge(e){if(typeof ee=="function")ee(e);else{console.error("initializeNavigation function is not defined. Ensure components/navigation.js is loaded.");return}typeof te=="function"?te():console.error("initializeLanguageSwitcher function not found. Ensure translation-dictionary.js is loaded correctly and defines it.");const t=document.getElementById("timezone-toggle");if(t&&(t.hasAttribute("data-listener-attached")||(t.addEventListener("click",Ce),t.setAttribute("data-listener-attached","true"))),typeof k=="function"&&typeof v<"u"&&v.length>0){const r=localStorage.getItem("preferredLanguage")||v[0];k(r)}else console.error("setLanguage function or languages array not found. Translation system might not be fully initialized.");Oe()}function Je(e,t,r,a={}){const n=document.getElementById(t);if(!n){console.error(`Container with ID ${t} not found`);return}if(n.innerHTML="",!e||e.length===0){n.textContent=a.noDataMessage||"No data available.";return}a.sortBy&&a.sortDirection&&e.sort((s,o)=>{const c=s&&typeof s=="object"&&Object.prototype.hasOwnProperty.call(s,a.sortBy)?s[a.sortBy]:void 0,d=o&&typeof o=="object"&&Object.prototype.hasOwnProperty.call(o,a.sortBy)?o[a.sortBy]:void 0;if(c==null)return a.sortDirection==="desc"?1:-1;if(d==null)return a.sortDirection==="desc"?-1:1;let l=0;return c>d?l=1:c<d&&(l=-1),a.sortDirection==="desc"?l*-1:l});let i=e;if(a.limit&&(i=e.slice(0,a.limit)),[...i].map(s=>{const o=r(s);o?n.appendChild(o):console.warn("Skipping invalid card for item:",s)}),typeof B=="function"&&B(),typeof k=="function"&&typeof v<"u"&&v.length>0){const s=localStorage.getItem("preferredLanguage")||v[0];k(s)}}export{fe as A,B as a,ue as b,le as c,Je as d,Y as e,je as f,_ as g,E as h,Ge as i,ke as j,we as k,v as l,Ne as m,Ke as n,V as o,oe as p,I as q,Re as r,k as s,x as t,Qe as u,Ze as v,Ye as w,Ve as x,z as y,Le as z};
